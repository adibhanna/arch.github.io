<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Architecture Framework</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', system-ui, sans-serif; }

        .progress-ring {
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-ring-circle {
            transition: stroke-dashoffset 0.5s ease;
        }

        .checkbox-custom {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .checkbox-custom:hover {
            transform: scale(1.1);
        }

        .section-expand {
            animation: expand 0.3s ease-out;
        }

        @keyframes expand {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-1px);
        }

        .dark .hover-lift:hover {
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
        }

        .light .hover-lift:hover {
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Icons
        const CheckCircle2 = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );

        const Circle = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
            </svg>
        );

        const ChevronDown = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="6 9 12 15 18 9"/>
            </svg>
        );

        const Download = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
        );

        const Sun = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="4"/>
                <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
            </svg>
        );

        const Moon = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
        );

        const Plus = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M5 12h14"/><path d="M12 5v14"/>
            </svg>
        );

        const X = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
            </svg>
        );

        const Users = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
        );

        const ChevronsDown = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m7 6 5 5 5-5"/><path d="m7 13 5 5 5-5"/>
            </svg>
        );

        const ChevronsUp = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m17 18-5-5-5 5"/><path d="m17 11-5-5-5 5"/>
            </svg>
        );

        const RotateCcw = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
            </svg>
        );

        const Save = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/>
            </svg>
        );

        const HelpCircle = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/>
            </svg>
        );

        const Github = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/>
            </svg>
        );

        const Link2 = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>
            </svg>
        );

        const Code = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>
            </svg>
        );

        const GitBranch = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="6" x2="6" y1="3" y2="15"/><circle cx="18" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><path d="M18 9a9 9 0 0 1-9 9"/>
            </svg>
        );

        const FileText = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/>
            </svg>
        );

        const ExternalLink = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/>
            </svg>
        );

        // Tooltip Component
        const Tooltip = ({ children, content, darkMode }) => {
            const [show, setShow] = useState(false);

            if (!content) return children;

            return (
                <div className="relative inline-flex">
                    <div
                        onMouseEnter={() => setShow(true)}
                        onMouseLeave={() => setShow(false)}
                        onClick={() => setShow(!show)}
                        className="cursor-help"
                    >
                        {children}
                    </div>
                    {show && (
                        <div className={`absolute z-50 left-6 top-0 w-64 p-3 text-xs rounded-lg shadow-lg border ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-300' : 'bg-white border-zinc-200 text-zinc-600'}`}>
                            {content}
                        </div>
                    )}
                </div>
            );
        };

        // Mermaid Diagram Component
        const MermaidDiagram = ({ code, darkMode, id }) => {
            const [svg, setSvg] = useState('');
            const [error, setError] = useState(null);

            useEffect(() => {
                if (!code.trim()) {
                    setSvg('');
                    setError(null);
                    return;
                }

                const renderDiagram = async () => {
                    try {
                        mermaid.initialize({
                            startOnLoad: false,
                            theme: darkMode ? 'dark' : 'default',
                            securityLevel: 'loose'
                        });
                        const { svg } = await mermaid.render(`mermaid-${id}`, code);
                        setSvg(svg);
                        setError(null);
                    } catch (e) {
                        setError(e.message || 'Invalid diagram syntax');
                        setSvg('');
                    }
                };

                renderDiagram();
            }, [code, darkMode, id]);

            if (!code.trim()) {
                return (
                    <div className={`text-xs ${darkMode ? 'text-zinc-600' : 'text-zinc-400'}`}>
                        Enter mermaid diagram code above to see preview
                    </div>
                );
            }

            if (error) {
                return (
                    <div className={`text-xs p-2 rounded ${darkMode ? 'bg-red-900/20 text-red-400' : 'bg-red-50 text-red-600'}`}>
                        {error}
                    </div>
                );
            }

            return (
                <div
                    className="mermaid-preview overflow-auto"
                    dangerouslySetInnerHTML={{ __html: svg }}
                />
            );
        };

        // Progress Ring Component
        const ProgressRing = ({ progress, size = 100, darkMode }) => {
            const strokeWidth = 6;
            const radius = (size - strokeWidth) / 2;
            const circumference = radius * 2 * Math.PI;
            const offset = circumference - (progress / 100) * circumference;

            return (
                <div className="relative inline-flex items-center justify-center">
                    <svg width={size} height={size} className="progress-ring">
                        <circle
                            className={darkMode ? "text-zinc-700" : "text-zinc-200"}
                            strokeWidth={strokeWidth}
                            stroke="currentColor"
                            fill="transparent"
                            r={radius}
                            cx={size / 2}
                            cy={size / 2}
                        />
                        <circle
                            className="progress-ring-circle"
                            strokeWidth={strokeWidth}
                            strokeDasharray={circumference}
                            strokeDashoffset={offset}
                            strokeLinecap="round"
                            stroke={darkMode ? "#a1a1aa" : "#52525b"}
                            fill="transparent"
                            r={radius}
                            cx={size / 2}
                            cy={size / 2}
                        />
                    </svg>
                    <div className="absolute flex flex-col items-center justify-center">
                        <span className={`text-2xl font-semibold ${darkMode ? 'text-zinc-100' : 'text-zinc-800'}`}>{progress}%</span>
                        <span className={`text-xs ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>complete</span>
                    </div>
                </div>
            );
        };

        const STORAGE_KEY = 'arch-framework-data';

        const ArchitectureFramework = () => {
            const [expandedSections, setExpandedSections] = useState({});
            const [checkedItems, setCheckedItems] = useState({});
            const [projectName, setProjectName] = useState('');
            const [notes, setNotes] = useState({});
            const [codeSnippets, setCodeSnippets] = useState({});
            const [diagrams, setDiagrams] = useState({});
            const [activeTabs, setActiveTabs] = useState({});
            const [stakeholders, setStakeholders] = useState([]);
            const [newStakeholder, setNewStakeholder] = useState({ name: '', role: '' });
            const [references, setReferences] = useState([]);
            const [newReference, setNewReference] = useState({ title: '', url: '' });
            const [lastSaved, setLastSaved] = useState(null);
            const [darkMode, setDarkMode] = useState(() => {
                if (typeof window !== 'undefined') {
                    const saved = localStorage.getItem('arch-framework-darkmode');
                    if (saved !== null) return JSON.parse(saved);
                    return window.matchMedia('(prefers-color-scheme: dark)').matches;
                }
                return false;
            });

            // Load from localStorage on mount
            useEffect(() => {
                try {
                    const saved = localStorage.getItem(STORAGE_KEY);
                    if (saved) {
                        const data = JSON.parse(saved);
                        if (data.checkedItems) setCheckedItems(data.checkedItems);
                        if (data.notes) setNotes(data.notes);
                        if (data.codeSnippets) setCodeSnippets(data.codeSnippets);
                        if (data.diagrams) setDiagrams(data.diagrams);
                        if (data.projectName) setProjectName(data.projectName);
                        if (data.expandedSections) setExpandedSections(data.expandedSections);
                        if (data.stakeholders) setStakeholders(data.stakeholders);
                        if (data.references) setReferences(data.references);
                        setLastSaved(new Date(data.savedAt));
                    }
                } catch (e) {
                    console.error('Failed to load saved data:', e);
                }
            }, []);

            // Save to localStorage on changes
            useEffect(() => {
                const timeoutId = setTimeout(() => {
                    try {
                        const data = {
                            checkedItems,
                            notes,
                            codeSnippets,
                            diagrams,
                            projectName,
                            expandedSections,
                            stakeholders,
                            references,
                            savedAt: new Date().toISOString()
                        };
                        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
                        setLastSaved(new Date());
                    } catch (e) {
                        console.error('Failed to save data:', e);
                    }
                }, 500);
                return () => clearTimeout(timeoutId);
            }, [checkedItems, notes, codeSnippets, diagrams, projectName, expandedSections, stakeholders, references]);

            useEffect(() => {
                document.documentElement.classList.toggle('dark', darkMode);
                localStorage.setItem('arch-framework-darkmode', JSON.stringify(darkMode));
            }, [darkMode]);

            const framework = [
                {
                    id: 'discovery',
                    phase: 'Discovery & Problem Definition',
                    number: '01',
                    description: 'Start by clearly defining the problem you\'re solving and understanding the constraints. This foundation prevents building the wrong thing and ensures alignment with business goals.',
                    sections: [
                        {
                            title: 'Problem Space',
                            description: 'Define the core problem and understand who you\'re building for.',
                            questions: [
                                { q: 'What problem are we solving? (One sentence)', tip: 'Force clarity by limiting to one sentence. If you can\'t explain it simply, you don\'t understand it well enough. This becomes your north star for all decisions.' },
                                { q: 'What happens if we build nothing?', tip: 'Understanding the cost of inaction helps prioritize and justify the project. Sometimes the answer reveals the problem isn\'t worth solving.' },
                                { q: 'Who are the primary users? Secondary users?', tip: 'Primary users are who you\'re optimizing for. Secondary users (admins, support staff) have different needs. Design for primary, accommodate secondary.' },
                                { q: 'What are their key pain points and frustrations?', tip: 'Focus on problems, not solutions. Users often ask for features when they really need outcomes. Dig deeper with "why" questions.' },
                                { q: 'What does success look like? How will we measure it?', tip: 'Define concrete, measurable outcomes. "Faster" isn\'t measurable; "reduce checkout time from 3 min to 30 sec" is. This prevents scope creep.' },
                                { q: 'What are the business goals and KPIs?', tip: 'Align technical decisions with business outcomes. Revenue, user growth, cost reduction, time-to-market—know which metrics matter most.' },
                                { q: 'Who are the key stakeholders? What are their priorities?', tip: 'Identify decision-makers, influencers, and blockers. Understanding their priorities helps navigate trade-offs and get buy-in.' },
                                { q: 'Are there competing solutions? What are their limitations?', tip: 'Study existing solutions (internal or external). Learn from their mistakes and identify opportunities for differentiation.' }
                            ]
                        },
                        {
                            title: 'Scope & Constraints',
                            description: 'Establish boundaries and identify limitations early.',
                            questions: [
                                { q: 'What\'s in scope for v1? What\'s explicitly out of scope?', tip: 'Write down what you WON\'T build. This prevents scope creep and sets expectations. "Out of scope" is as important as "in scope".' },
                                { q: 'What\'s the timeline? Are there hard deadlines?', tip: 'Distinguish between real deadlines (regulatory, contractual) and artificial ones. Hard deadlines constrain scope; soft deadlines can flex.' },
                                { q: 'What\'s the budget? (Infrastructure, team, tooling)', tip: 'Include all costs: cloud infrastructure, third-party services, team salaries, tooling licenses. Budget constraints drive build vs buy decisions.' },
                                { q: 'What existing systems must we integrate with?', tip: 'Legacy systems often dictate architecture choices. Understand their APIs, data formats, availability, and limitations upfront.' },
                                { q: 'Any regulatory/compliance requirements? (GDPR, HIPAA, SOC2, PCI-DSS)', tip: 'Compliance requirements affect data storage, encryption, audit logging, and geography. Retrofitting compliance is expensive—design for it.' },
                                { q: 'Any technical constraints? (Must use X, cannot use Y)', tip: 'Organizational standards, existing expertise, vendor relationships, or security policies may limit technology choices.' },
                                { q: 'What are the non-negotiable requirements vs nice-to-haves?', tip: 'Use MoSCoW (Must/Should/Could/Won\'t) or similar. This helps when you inevitably need to cut scope.' },
                                { q: 'Are there organizational or political constraints to consider?', tip: 'Team structures, reporting lines, budget ownership, and inter-team dynamics affect architecture. Conway\'s Law is real.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'requirements',
                    phase: 'Requirements Analysis',
                    number: '02',
                    description: 'Quantify your system\'s needs. Vague requirements lead to over-engineering or under-building. Get specific numbers for scale, performance, and reliability.',
                    sections: [
                        {
                            title: 'Scale & Performance',
                            description: 'Understand traffic patterns and growth projections to size your system correctly.',
                            questions: [
                                { q: 'Expected users: Day 1? Month 1? Year 1? Year 3?', tip: 'Get realistic projections, not optimistic marketing numbers. Design for Year 1 with a path to Year 3. Don\'t over-engineer for Day 1.' },
                                { q: 'Requests per second: Average? Peak? Burst capacity needed?', tip: 'Peak can be 10-100x average. Know your traffic shape. Burst capacity = handling sudden spikes without degradation.' },
                                { q: 'Data volume: Initial size? Daily growth rate? Total after 1 year?', tip: 'Calculate storage needs, backup costs, and query performance implications. Data grows faster than you expect.' },
                                { q: 'Latency requirements: P50? P95? P99? Hard limits?', tip: 'P50 is median, P99 is worst case for 99% of requests. User-facing usually needs P95 < 200ms. P99 catches tail latency issues.' },
                                { q: 'Throughput requirements: Reads/sec? Writes/sec?', tip: 'Read-heavy systems (100:1) vs write-heavy (1:1) need different architectures. This drives database and caching decisions.' },
                                { q: 'Geographic distribution: Single region? Multi-region? Global?', tip: 'Multi-region adds complexity and cost but improves latency and availability. Global requires careful data residency planning.' },
                                { q: 'Traffic patterns: Steady? Bursty? Predictable spikes? Seasonal?', tip: 'Bursty traffic needs auto-scaling. Predictable spikes (Black Friday) can be pre-scaled. Steady traffic is easiest to plan for.' },
                                { q: 'What are the expected concurrent users at peak?', tip: 'Concurrent users ≠ requests/sec. One user might make 10 requests. This affects connection pooling, session storage, and WebSocket capacity.' },
                                { q: 'Are there batch processing requirements? Volume? Frequency?', tip: 'Batch jobs compete for resources with real-time traffic. Schedule them during off-peak or use separate infrastructure.' }
                            ]
                        },
                        {
                            title: 'Availability & Reliability',
                            description: 'Define uptime targets and understand the cost of failures.',
                            questions: [
                                { q: 'Required uptime: 99%? 99.9%? 99.99%? 99.999%?', tip: '99% = 3.65 days downtime/year. 99.9% = 8.76 hours. 99.99% = 52.6 minutes. Each "nine" costs exponentially more.' },
                                { q: 'What\'s the acceptable downtime per month/year?', tip: 'Translate percentages to real time. 99.9% monthly = 43 minutes. Is that one 43-min outage or forty-three 1-min blips?' },
                                { q: 'Recovery Time Objective (RTO)? How fast must we recover?', tip: 'RTO is max acceptable downtime after a disaster. 4-hour RTO needs different infrastructure than 15-minute RTO.' },
                                { q: 'Recovery Point Objective (RPO)? How much data loss is acceptable?', tip: 'RPO is max acceptable data loss. Zero RPO requires synchronous replication. 1-hour RPO allows hourly backups.' },
                                { q: 'Can we have scheduled maintenance windows? When?', tip: 'Maintenance windows simplify operations but may not be acceptable for global 24/7 services. Plan for zero-downtime deployments if needed.' },
                                { q: 'What\'s the business cost of downtime per hour?', tip: 'Quantify in dollars: lost revenue, SLA penalties, customer churn, reputation damage. This justifies infrastructure investment.' },
                                { q: 'What SLAs do we need to offer to customers?', tip: 'External SLAs should be less aggressive than internal targets. Leave margin for error. SLA breaches have financial and legal consequences.' },
                                { q: 'Are there external dependencies with their own SLAs?', tip: 'Your availability can\'t exceed your dependencies\' availability. If a critical API offers 99.9%, you can\'t promise 99.99%.' },
                                { q: 'What\'s the acceptable error rate? (e.g., 0.1% of requests)', tip: 'Error budgets define acceptable failure. 0.1% error rate = 1 in 1000 requests can fail. This guides retry logic and alerting thresholds.' }
                            ]
                        },
                        {
                            title: 'Data Requirements',
                            description: 'Clarify consistency needs, access patterns, and data lifecycle.',
                            questions: [
                                { q: 'Strong consistency needed? Or eventual consistency OK? Where?', tip: 'Strong consistency = every read sees latest write. Eventual = reads may be stale temporarily. Financial data usually needs strong; social feeds can be eventual.' },
                                { q: 'Read-heavy or write-heavy workload? Ratio?', tip: 'Read-heavy (100:1) benefits from caching and read replicas. Write-heavy (1:1) needs careful database selection and write optimization.' },
                                { q: 'Data retention requirements? Legal minimums/maximums?', tip: 'Some data must be kept (audit logs, financial records). Some must be deleted (GDPR). Know the rules for each data type.' },
                                { q: 'Backup frequency needed? Full vs incremental?', tip: 'Full backups are slow but simple to restore. Incrementals are fast but complex. Frequency depends on RPO and data change rate.' },
                                { q: 'Any data sovereignty requirements? Data residency laws?', tip: 'Some countries require data to stay within borders (EU, China, Russia). This affects cloud region selection and replication strategy.' },
                                { q: 'PII or sensitive data involved? Classification levels?', tip: 'Classify data by sensitivity: public, internal, confidential, restricted. Each level has different encryption, access, and audit requirements.' },
                                { q: 'Real-time data needs vs batch processing acceptable?', tip: 'Real-time requires streaming architecture (Kafka, Kinesis). Batch is simpler and cheaper. Many use cases that seem real-time actually tolerate minutes of delay.' },
                                { q: 'Data archival strategy? Hot/warm/cold storage tiers?', tip: 'Hot = frequent access, high cost. Cold = rare access, low cost. Archive old data to reduce costs and improve query performance.' },
                                { q: 'Audit trail requirements? Immutability needs?', tip: 'Regulated industries need immutable audit logs. Consider append-only tables, write-once storage, or blockchain for tamper-proof records.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'data-modeling',
                    phase: 'Data & Domain Modeling',
                    number: '03',
                    description: 'Model your domain before writing code. Understanding entities, relationships, and boundaries prevents costly refactors and enables better service decomposition.',
                    sections: [
                        {
                            title: 'Core Entities',
                            description: 'Identify the key concepts and how they relate to each other.',
                            questions: [
                                { q: 'What are the main entities/concepts in the domain?', tip: 'List nouns from requirements: User, Order, Product, Payment. These become your tables/collections and often your services.' },
                                { q: 'What are the relationships between entities?', tip: 'Draw an entity-relationship diagram. User has many Orders, Order has many Products. Relationships drive join strategies and API design.' },
                                { q: 'Which entities are immutable? Which change frequently?', tip: 'Immutable data (events, audit logs) is easier to cache and replicate. Mutable data (user profiles) needs careful consistency handling.' },
                                { q: 'What\'s the cardinality? (1:1, 1:many, many:many)', tip: 'Cardinality affects table design. Many:many needs junction tables. High-cardinality relationships (user has 1M followers) need special handling.' },
                                { q: 'What are the access patterns for each entity?', tip: 'How will data be queried? By ID? By date range? Full-text search? Access patterns determine indexes and sometimes database choice.' },
                                { q: 'What\'s the source of truth for each entity?', tip: 'In distributed systems, one service owns each entity. Others get copies. This prevents conflicting updates and simplifies consistency.' },
                                { q: 'What are the key identifiers? Natural keys vs surrogate keys?', tip: 'Natural keys (email, SSN) have meaning but can change. Surrogate keys (UUID, auto-increment) are stable but meaningless. Often use both.' },
                                { q: 'What attributes are required vs optional?', tip: 'Required fields must be validated. Optional fields complicate queries (NULL handling). Minimize optional fields for cleaner data.' },
                                { q: 'Are there temporal aspects? (Versioning, history, effective dates)', tip: 'Do you need to query "what was the price on Jan 1"? Temporal data requires special schema design (valid_from, valid_to columns).' }
                            ]
                        },
                        {
                            title: 'Domain Boundaries',
                            description: 'Define logical separations that will guide your architecture.',
                            questions: [
                                { q: 'What are the logical domains/bounded contexts?', tip: 'From Domain-Driven Design: areas where terms have specific meaning. "Customer" means different things to Sales vs Support. Separate these.' },
                                { q: 'Which domains are core vs supporting vs generic?', tip: 'Core = competitive advantage, build it. Supporting = necessary but not differentiating. Generic = commodity, buy it (auth, payments).' },
                                { q: 'Where do domain boundaries align with team boundaries?', tip: 'Conway\'s Law: system structure mirrors org structure. Align boundaries with teams for clear ownership and reduced coordination.' },
                                { q: 'Which domains can evolve independently?', tip: 'Loosely coupled domains can be deployed separately. Tightly coupled ones must be coordinated. Aim for loose coupling.' },
                                { q: 'What events happen across domain boundaries?', tip: 'Events decouple domains. OrderPlaced, PaymentReceived, ShipmentSent. These become your integration contracts.' },
                                { q: 'Which domains have different consistency requirements?', tip: 'Payments need strong consistency. Recommendations can be eventually consistent. Don\'t apply the strictest requirement everywhere.' },
                                { q: 'Where are the transaction boundaries?', tip: 'Transactions within a domain are easy. Cross-domain transactions are hard (sagas, 2PC). Design to minimize cross-domain transactions.' },
                                { q: 'What data needs to be replicated across domains?', tip: 'Some data is needed everywhere (user info). Replicate via events or shared cache. Accept eventual consistency for replicated data.' }
                            ]
                        },
                        {
                            title: 'Data Storage Strategy',
                            description: 'Choose the right storage solutions for your data patterns.',
                            questions: [
                                { q: 'What database type fits each data pattern? (Relational, Document, Key-Value, Graph, Time-series)', tip: 'Relational for transactions, Document for flexible schemas, Key-Value for caching, Graph for relationships, Time-series for metrics. Match the tool to the problem.' },
                                { q: 'What indexing strategy is needed? Primary, secondary, composite indexes?', tip: 'Indexes speed reads but slow writes. Index columns used in WHERE, JOIN, ORDER BY. Composite indexes for multi-column queries.' },
                                { q: 'Partitioning/sharding strategy? By what key? How many partitions?', tip: 'Partition by a key that distributes evenly and matches query patterns. User ID for user data, timestamp for time-series. Start with few partitions.' },
                                { q: 'Denormalization trade-offs? Where is it worth it?', tip: 'Denormalization speeds reads by duplicating data. Worth it for hot read paths. Increases write complexity and storage. Don\'t denormalize prematurely.' },
                                { q: 'What are the query patterns? Simple lookups vs complex queries?', tip: 'Simple lookups = key-value or document store. Complex joins = relational. Analytics = columnar (BigQuery, Redshift). Match database to query pattern.' },
                                { q: 'Full-text search requirements? Which fields?', tip: 'Full-text search usually needs a dedicated engine (Elasticsearch, Algolia). Database full-text is limited but avoids another system.' },
                                { q: 'Caching strategy at the data layer? Cache-aside, write-through, write-behind?', tip: 'Cache-aside: app manages cache. Write-through: write to cache and DB. Write-behind: write to cache, async to DB. Each has consistency trade-offs.' },
                                { q: 'Data migration strategy from existing systems?', tip: 'Big bang (downtime) vs gradual (dual-write + backfill). Plan for rollback. Validate data integrity. Migration often takes longer than expected.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'api-design',
                    phase: 'API Design',
                    number: '04',
                    description: 'APIs are contracts. Design them carefully as they\'re hard to change once published. Consider consumers, versioning, and long-term evolution.',
                    sections: [
                        {
                            title: 'API Strategy',
                            description: 'Define your overall approach to API design.',
                            questions: [
                                { q: 'API style: REST? GraphQL? gRPC? Event-driven? Why?', tip: 'REST for simplicity and caching. GraphQL for flexible queries. gRPC for performance and streaming. Event-driven for async workflows. Choose based on use case.' },
                                { q: 'Who are the API consumers? Internal services? External partners? Public developers?', tip: 'Internal APIs can change faster. External APIs need stability, versioning, and documentation. Public APIs need rate limiting and abuse protection.' },
                                { q: 'Synchronous vs asynchronous communication? Where?', tip: 'Sync for immediate responses (user-facing). Async for long operations, decoupling, and reliability. Many systems use both.' },
                                { q: 'Request/response format: JSON? Protocol Buffers? XML?', tip: 'JSON for humans and web. Protocol Buffers for performance and type safety. XML for legacy enterprise. JSON is the safe default.' },
                                { q: 'API gateway needed? What functionality? (Auth, rate limiting, transformation)', tip: 'Gateways centralize cross-cutting concerns. Useful for auth, rate limiting, logging, and transforming legacy APIs. Adds latency and complexity.' },
                                { q: 'Service mesh requirements? (Istio, Linkerd, Consul)', tip: 'Service meshes handle service-to-service communication: mTLS, retries, circuit breakers. Valuable at scale but complex to operate.' },
                                { q: 'How will APIs be discovered? Service registry? API catalog?', tip: 'Service registries (Consul, Eureka) for runtime discovery. API catalogs for documentation and governance. Both matter at scale.' }
                            ]
                        },
                        {
                            title: 'API Contracts',
                            description: 'Define clear contracts and standards.',
                            questions: [
                                'How will APIs be documented? OpenAPI/Swagger? GraphQL schema?',
                                'Naming conventions: URL structure, field names, error codes?',
                                'Pagination strategy: Cursor-based? Offset? Keyset?',
                                'Filtering and sorting conventions?',
                                'Error handling: Error format? HTTP status codes? Error codes?',
                                'Idempotency requirements? Idempotency keys?',
                                'Request validation: Where? How strict?',
                                'Response envelope structure? Metadata? Links (HATEOAS)?'
                            ]
                        },
                        {
                            title: 'API Versioning & Evolution',
                            description: 'Plan for change without breaking consumers.',
                            questions: [
                                'Versioning strategy: URL path? Header? Query param?',
                                'Breaking vs non-breaking change policy?',
                                'Deprecation process: Timeline? Communication? Sunset headers?',
                                'Backward compatibility requirements: How many versions supported?',
                                'How will you handle schema evolution?',
                                'Contract testing between services?',
                                'API changelog and migration guides?'
                            ]
                        }
                    ]
                },
                {
                    id: 'architecture',
                    phase: 'Architecture Design',
                    number: '05',
                    description: 'Make deliberate choices about system structure and technology. Document trade-offs explicitly—every decision has costs and benefits.',
                    sections: [
                        {
                            title: 'System Structure',
                            description: 'Define how components are organized and communicate.',
                            questions: [
                                'Monolith, modular monolith, or microservices? Why?',
                                'What are the major components/services?',
                                'Which components are synchronous? Asynchronous?',
                                'What are the external dependencies?',
                                'Single database or database per service? Why?',
                                'How do services communicate? HTTP? Message queues? Events?',
                                'What\'s the deployment unit? (Container, function, VM)',
                                'Serverless components? Where does it make sense?'
                            ]
                        },
                        {
                            title: 'Technology Choices',
                            description: 'Select tools and frameworks based on requirements, not trends.',
                            questions: [
                                'Primary programming language(s)? Why?',
                                'Framework choices? Why these over alternatives?',
                                'Database(s): Which ones? Why? (PostgreSQL, MongoDB, Redis, etc.)',
                                'Message queue/event bus: Which one? (Kafka, RabbitMQ, SQS, etc.)',
                                'Search infrastructure: Elasticsearch? Algolia? Database full-text?',
                                'File/blob storage: S3? GCS? Azure Blob?',
                                'CDN requirements? Which provider?',
                                'Infrastructure: AWS? GCP? Azure? On-prem? Multi-cloud?'
                            ]
                        },
                        {
                            title: 'Caching Strategy',
                            description: 'Design caching layers to optimize performance and reduce load.',
                            questions: [
                                'What layers need caching? (Browser, CDN, Application, Database)',
                                'Cache technology: Redis? Memcached? In-memory?',
                                'Cache invalidation strategy: TTL? Event-based? Manual?',
                                'Cache-aside, read-through, or write-through pattern?',
                                'What\'s the cache hit ratio target?',
                                'Cache warming strategy for cold starts?',
                                'Distributed caching requirements? Consistency?',
                                'Cache key design: Namespacing? Versioning?'
                            ]
                        },
                        {
                            title: 'Trade-offs & Decisions',
                            description: 'Document the compromises you\'re making and why.',
                            questions: [
                                'Consistency vs Availability: Which did we prioritize? Why?',
                                'Simplicity vs Flexibility: Where did we compromise?',
                                'Cost vs Performance: What\'s our optimization target?',
                                'Time to market vs Perfect design: What\'s the balance?',
                                'Build vs Buy: What are we building? What are we buying?',
                                'What technical debt are we intentionally accepting?',
                                'What are the key architectural decision records (ADRs)?',
                                'What would we do differently with more time/budget?'
                            ]
                        }
                    ]
                },
                {
                    id: 'testing',
                    phase: 'Testing Strategy',
                    number: '06',
                    description: 'Define how you\'ll verify the system works correctly. A comprehensive testing strategy catches bugs early and enables confident deployments.',
                    sections: [
                        {
                            title: 'Test Pyramid',
                            description: 'Plan your testing layers and coverage targets.',
                            questions: [
                                'Unit test coverage target? What\'s worth unit testing?',
                                'Integration test strategy: What integrations to test?',
                                'End-to-end test coverage: Critical user journeys?',
                                'Contract testing between services?',
                                'What testing frameworks and tools?',
                                'Test data management: Fixtures? Factories? Production snapshots?',
                                'Mocking strategy: What to mock? What to test against real services?',
                                'Code coverage requirements? Coverage tools?'
                            ]
                        },
                        {
                            title: 'Performance & Load Testing',
                            description: 'Verify the system meets performance requirements.',
                            questions: [
                                'Load testing approach: Tools? (k6, Gatling, Locust, JMeter)',
                                'Performance benchmarks: What latency targets?',
                                'Stress testing: How far beyond normal load?',
                                'Soak testing: Long-running stability tests?',
                                'Capacity planning: How to determine scaling thresholds?',
                                'Performance regression testing in CI/CD?',
                                'Database query performance testing?',
                                'Third-party dependency performance impact?'
                            ]
                        },
                        {
                            title: 'Specialized Testing',
                            description: 'Additional testing for specific quality attributes.',
                            questions: [
                                'Security testing: SAST? DAST? Penetration testing schedule?',
                                'Accessibility testing: WCAG compliance level? Tools?',
                                'Chaos engineering: Failure injection testing? (Chaos Monkey, Gremlin)',
                                'Data integrity testing: Consistency checks?',
                                'Backup/restore testing: How often verified?',
                                'Disaster recovery drills: Frequency? Scope?',
                                'Browser/device compatibility testing matrix?',
                                'API compatibility testing for breaking changes?'
                            ]
                        }
                    ]
                },
                {
                    id: 'cicd',
                    phase: 'CI/CD & Deployment',
                    number: '07',
                    description: 'Automate your path to production. Good CI/CD practices enable fast, reliable, and safe deployments.',
                    sections: [
                        {
                            title: 'Build & Integration',
                            description: 'Define your continuous integration pipeline.',
                            questions: [
                                'CI platform: GitHub Actions? GitLab CI? Jenkins? CircleCI?',
                                'Build pipeline stages: Lint, test, build, scan, publish?',
                                'Build time target? Current build time?',
                                'Artifact management: Container registry? Package registry?',
                                'Dependency scanning: Vulnerabilities? License compliance?',
                                'Code quality gates: Coverage? Complexity? Duplication?',
                                'Branch strategy: GitFlow? Trunk-based? GitHub Flow?',
                                'Merge requirements: Reviews? CI passing? Approvals?'
                            ]
                        },
                        {
                            title: 'Deployment Strategy',
                            description: 'Define how changes reach production.',
                            questions: [
                                'Deployment frequency target: Daily? Weekly? Continuous?',
                                'Deployment strategy: Rolling? Blue-green? Canary? Feature flags?',
                                'Environment progression: Dev → Staging → Production?',
                                'Infrastructure as Code: Terraform? CloudFormation? Pulumi?',
                                'Container orchestration: Kubernetes? ECS? Nomad?',
                                'Database migration strategy: How applied? Rollback plan?',
                                'Configuration management: Environment variables? Secrets manager?',
                                'Deployment approval process: Manual gates? Automated?'
                            ]
                        },
                        {
                            title: 'Release Management',
                            description: 'Control and manage releases safely.',
                            questions: [
                                'Feature flags system: LaunchDarkly? Unleash? Custom?',
                                'Rollback strategy: Automated? Manual? Time to rollback?',
                                'Hotfix process: Emergency deployment path?',
                                'Release notes: Automated generation? Changelog format?',
                                'Deployment windows: Any restricted times?',
                                'Smoke tests post-deployment: What\'s verified?',
                                'Deployment metrics: Success rate? Frequency? Lead time?',
                                'Progressive rollout: Percentage-based? User segment-based?'
                            ]
                        }
                    ]
                },
                {
                    id: 'resilience',
                    phase: 'Resilience & Failure Planning',
                    number: '08',
                    description: 'Plan for failure before it happens. Systems fail—the question is whether you\'ve designed for graceful degradation and quick recovery.',
                    sections: [
                        {
                            title: 'Failure Modes',
                            description: 'Identify what can go wrong and assess the impact.',
                            questions: [
                                'What are the single points of failure?',
                                'What happens when each component fails?',
                                'What are the cascading failure risks?',
                                'Can we degrade gracefully? How? Which features?',
                                'What\'s the blast radius of each failure?',
                                'Which failures are acceptable? Which are catastrophic?',
                                'Dependency failure impact: What if each dependency is down?',
                                'Data corruption scenarios: Detection? Recovery?'
                            ]
                        },
                        {
                            title: 'Resilience Patterns',
                            description: 'Implement patterns to handle failures gracefully.',
                            questions: [
                                'Circuit breakers: Where? What thresholds? Fallback behavior?',
                                'Retry logic: Where? What backoff strategy? Max attempts?',
                                'Timeouts: What values? Connection vs read timeouts?',
                                'Bulkheads: Resource isolation between components?',
                                'Rate limiting: Where? What limits? Per user? Per IP?',
                                'Load shedding: Priority of requests when overloaded?',
                                'Fallback strategies: Cached responses? Default values? Degraded mode?',
                                'Health checks: Liveness? Readiness? Dependencies included?'
                            ]
                        },
                        {
                            title: 'Recovery & Redundancy',
                            description: 'Design mechanisms to recover quickly and prevent data loss.',
                            questions: [
                                'Backup strategy: What? How often? Where stored? Tested when?',
                                'Point-in-time recovery capability?',
                                'Disaster recovery plan: Documented? Tested? RTO/RPO met?',
                                'Redundancy: Active-active? Active-passive? Multi-region?',
                                'Failover process: Automatic? Manual? DNS-based?',
                                'Data replication: Sync? Async? Lag tolerance?',
                                'Incident response process: Runbooks? On-call rotation?',
                                'Post-incident review process: Blameless? Action items tracked?'
                            ]
                        }
                    ]
                },
                {
                    id: 'security',
                    phase: 'Security & Privacy',
                    number: '09',
                    description: 'Build security in from the start, not as an afterthought. Consider authentication, authorization, data protection, and compliance requirements.',
                    sections: [
                        {
                            title: 'Authentication & Authorization',
                            description: 'Define how users and services prove identity and access resources.',
                            questions: [
                                'Authentication method: OAuth2? SAML? OIDC? API keys?',
                                'Identity provider: Build vs buy? (Auth0, Okta, Cognito, Keycloak)',
                                'Multi-factor authentication: Required? Which factors?',
                                'Session management: Tokens? Cookies? Expiration policy?',
                                'Authorization model: RBAC? ABAC? Policy-based?',
                                'Permission granularity: Resource-level? Field-level?',
                                'Service-to-service auth: mTLS? Service accounts? JWT?',
                                'API authentication: API keys? OAuth tokens? Both?'
                            ]
                        },
                        {
                            title: 'Data Protection',
                            description: 'Protect data at rest, in transit, and in use.',
                            questions: [
                                'Encryption at rest: What data? What algorithm? Key management?',
                                'Encryption in transit: TLS version? Certificate management?',
                                'Secret management: Where stored? (Vault, AWS Secrets Manager, etc.)',
                                'Key rotation policy: Frequency? Automation?',
                                'PII handling: Identification? Encryption? Tokenization? Masking?',
                                'Data classification: Levels? Handling requirements per level?',
                                'Database encryption: Column-level? Table-level? Disk-level?',
                                'Backup encryption: Same keys? Different keys?'
                            ]
                        },
                        {
                            title: 'Security Practices',
                            description: 'Establish security processes and controls.',
                            questions: [
                                'Security scanning: SAST tools? DAST tools? Container scanning?',
                                'Dependency vulnerability scanning: Frequency? Remediation SLA?',
                                'Penetration testing: Frequency? Scope? Internal or third-party?',
                                'Security review process: When required? Who reviews?',
                                'OWASP Top 10: How addressed? (Injection, XSS, CSRF, etc.)',
                                'DDoS protection: CDN? WAF? Rate limiting?',
                                'Audit logging: What\'s logged? Retention? Access controls?',
                                'Incident response plan: Security-specific procedures?'
                            ]
                        },
                        {
                            title: 'Privacy & Compliance',
                            description: 'Ensure you handle user data responsibly and legally.',
                            questions: [
                                'What PII do we collect? Why? Minimization applied?',
                                'Data retention policy: How long? Automated deletion?',
                                'Right to deletion (RTBF): How implemented? Timeline?',
                                'Data portability: Export format? Delivery method?',
                                'Consent management: How captured? How honored?',
                                'Privacy by design: Data flow mapping? Impact assessments?',
                                'Compliance requirements: GDPR? CCPA? HIPAA? SOC2? PCI-DSS?',
                                'Third-party data sharing: DPAs in place? Purpose limitations?'
                            ]
                        }
                    ]
                },
                {
                    id: 'observability',
                    phase: 'Observability & Operations',
                    number: '10',
                    description: 'You can\'t fix what you can\'t see. Plan how you\'ll monitor, debug, and operate the system in production from day one.',
                    sections: [
                        {
                            title: 'Monitoring & Metrics',
                            description: 'Define what to measure and how to know when things go wrong.',
                            questions: [
                                'Key metrics: What are the Golden Signals? (Latency, traffic, errors, saturation)',
                                'Business metrics: What do stakeholders need to see?',
                                'Infrastructure metrics: CPU, memory, disk, network?',
                                'Application metrics: Request rates, response times, queue depths?',
                                'Custom metrics: What domain-specific metrics?',
                                'Metrics platform: Prometheus? Datadog? CloudWatch? New Relic?',
                                'Dashboards: What views? Who\'s the audience?',
                                'SLIs/SLOs/SLAs defined? Error budgets calculated?'
                            ]
                        },
                        {
                            title: 'Alerting',
                            description: 'Define when and how to notify the team of issues.',
                            questions: [
                                'Alerting thresholds: What triggers alerts? Avoid alert fatigue?',
                                'Severity levels: P1/P2/P3? Response time expectations?',
                                'Notification channels: PagerDuty? Slack? Email? Phone?',
                                'Escalation policy: Who\'s paged? When to escalate?',
                                'On-call rotation: Schedule? Compensation? Handoff process?',
                                'Alert runbooks: Documented response procedures?',
                                'Alert aggregation: Grouping related alerts?',
                                'Maintenance windows: Silencing alerts during deployments?'
                            ]
                        },
                        {
                            title: 'Logging & Tracing',
                            description: 'Enable debugging and understanding of system behavior.',
                            questions: [
                                'Logging format: Structured (JSON)? Log levels?',
                                'Log aggregation: ELK? Splunk? CloudWatch Logs? Loki?',
                                'Log retention: How long? Tiered storage?',
                                'Distributed tracing: OpenTelemetry? Jaeger? Zipkin? X-Ray?',
                                'Trace sampling strategy: Head-based? Tail-based? Rate?',
                                'Correlation IDs: How propagated across services?',
                                'What to log: Requests? Errors? Debug info? PII concerns?',
                                'Log-based alerting: Error rate spikes? Specific patterns?'
                            ]
                        },
                        {
                            title: 'Debugging & Profiling',
                            description: 'Tools and processes for investigating issues.',
                            questions: [
                                'APM tool: Datadog? New Relic? Dynatrace?',
                                'Profiling: CPU? Memory? When enabled?',
                                'Error tracking: Sentry? Rollbar? Bugsnag?',
                                'How to debug production issues safely?',
                                'Feature flags for debug modes?',
                                'Access to production logs: Who? How? Audit trail?',
                                'Reproduction environments: Can we replicate prod issues?',
                                'Post-mortem process: Template? Frequency? Tracking?'
                            ]
                        }
                    ]
                },
                {
                    id: 'cost',
                    phase: 'Cost & Resource Planning',
                    number: '11',
                    description: 'Understand and optimize the cost of running your system. Cloud costs can grow quickly without proper planning and monitoring.',
                    sections: [
                        {
                            title: 'Cost Estimation',
                            description: 'Estimate infrastructure and operational costs.',
                            questions: [
                                'Compute costs: Instance types? Sizing? Reserved vs on-demand?',
                                'Storage costs: Data volume? Storage tiers? Growth rate?',
                                'Network costs: Data transfer? Cross-region? CDN?',
                                'Database costs: Instance size? Storage? IOPS? Replicas?',
                                'Third-party service costs: APIs? SaaS tools? Licenses?',
                                'Total monthly cost estimate? Annual projection?',
                                'Cost per user/request/transaction?',
                                'Budget limits and alerts?'
                            ]
                        },
                        {
                            title: 'Cost Optimization',
                            description: 'Strategies to reduce and control costs.',
                            questions: [
                                'Reserved instances/savings plans: Commitment level?',
                                'Spot/preemptible instances: Where applicable?',
                                'Auto-scaling policies: Scale-down aggressive enough?',
                                'Right-sizing: Regular review of resource utilization?',
                                'Storage lifecycle policies: Auto-archive? Auto-delete?',
                                'Caching ROI: Cost savings from caching layer?',
                                'Multi-tenancy efficiency: Resource sharing between tenants?',
                                'Development/staging cost controls: Shutdown schedules?'
                            ]
                        },
                        {
                            title: 'Cost Monitoring',
                            description: 'Track and manage costs over time.',
                            questions: [
                                'Cost allocation tags: By team? By feature? By environment?',
                                'Cost anomaly detection: Alerts for unexpected spikes?',
                                'Showback/chargeback model: How costs attributed to teams?',
                                'Regular cost review: Frequency? Who\'s involved?',
                                'FinOps practices: Dedicated role? Tools?',
                                'Cost forecasting: Based on growth projections?',
                                'Optimization opportunities tracking?',
                                'Vendor contract reviews: Annual? Negotiation strategy?'
                            ]
                        }
                    ]
                },
                {
                    id: 'team',
                    phase: 'Team & Organization',
                    number: '12',
                    description: 'Architecture must match team capabilities and structure. The best technical design fails if the team can\'t build or maintain it.',
                    sections: [
                        {
                            title: 'Team Capabilities',
                            description: 'Assess whether your team can build and maintain this system.',
                            questions: [
                                'Team size: Current? 6 months? 1 year?',
                                'Team expertise: Strengths? Gaps? Training needed?',
                                'Learning curve: Can the team realistically support this?',
                                'Cognitive load: Is this architecture too complex?',
                                'Hiring plan: What roles needed? Timeline?',
                                'Contractor/consultant needs: What expertise to bring in?',
                                'Knowledge concentration risk: Bus factor?',
                                'Cross-training plan: Reducing single points of knowledge?'
                            ]
                        },
                        {
                            title: 'Team Structure',
                            description: 'Align architecture with organizational structure.',
                            questions: [
                                'Conway\'s Law: Does architecture match team structure?',
                                'Team autonomy: Can teams deploy independently?',
                                'Service ownership: Clear owners for each component?',
                                'On-call responsibility: Who owns production issues?',
                                'Communication patterns: Sync? Async? Meeting cadence?',
                                'Decision-making process: RFCs? ADRs? Architecture review?',
                                'Cross-team dependencies: How managed?',
                                'Platform team: Dedicated infrastructure/platform support?'
                            ]
                        },
                        {
                            title: 'Operational Burden',
                            description: 'Consider the ongoing cost of running and evolving the system.',
                            questions: [
                                'Deployment frequency: Current? Target?',
                                'Deployment complexity: Steps? Automation level?',
                                'Incident frequency: Current? Target?',
                                'MTTR (Mean Time to Recovery): Current? Target?',
                                'Technical debt management: How tracked? When addressed?',
                                'Toil reduction: Automation opportunities?',
                                'Documentation maintenance: Who? How kept current?',
                                'Onboarding time: How long for new team members?'
                            ]
                        }
                    ]
                },
                {
                    id: 'evolution',
                    phase: 'Evolution & Future-Proofing',
                    number: '13',
                    description: 'Systems evolve. Design for change by identifying what\'s likely to change, what\'s hard to change, and how you\'ll migrate without disruption.',
                    sections: [
                        {
                            title: 'Change Management',
                            description: 'Plan how to evolve the system safely over time.',
                            questions: [
                                'What will we learn post-launch that might change things?',
                                'Which parts are hardest to change later?',
                                'Which parts should stay flexible?',
                                'Migration strategy: How do we evolve without downtime?',
                                'Versioning strategy: APIs? Data schemas? Configurations?',
                                'Deprecation strategy: How do we sunset old versions?',
                                'Feature flags: Gradual rollout? A/B testing infrastructure?',
                                'Database schema evolution: Online migrations? Expand/contract?'
                            ]
                        },
                        {
                            title: 'Scalability Planning',
                            description: 'Anticipate and plan for growth.',
                            questions: [
                                'What\'s our scale plan? 10x? 100x?',
                                'Which components will hit limits first?',
                                'Horizontal vs vertical scaling: Where each applies?',
                                'Database scaling path: Read replicas? Sharding? NewSQL?',
                                'Caching scaling: Cluster? Sharding?',
                                'What architectural changes needed at each scale milestone?',
                                'Multi-region expansion plan?',
                                'What would break if we 10x users tomorrow?'
                            ]
                        },
                        {
                            title: 'Future Considerations',
                            description: 'Think ahead to future needs and opportunities.',
                            questions: [
                                'What new features are on the roadmap?',
                                'How does this architecture enable/constrain future products?',
                                'Technology refresh: When will current choices become obsolete?',
                                'Vendor lock-in assessment: What\'s the exit cost?',
                                'Open source vs proprietary: Long-term implications?',
                                'AI/ML integration: Future data and compute needs?',
                                'Regulatory changes: Anticipated compliance requirements?',
                                'Acquisition/integration: How hard to integrate/be integrated?'
                            ]
                        }
                    ]
                }
            ];

            // Calculate all section keys for expand/collapse all
            const allSectionKeys = useMemo(() => {
                const keys = [];
                framework.forEach(phase => {
                    phase.sections.forEach((_, sIndex) => {
                        keys.push(`${phase.id}-${sIndex}`);
                    });
                });
                return keys;
            }, []);

            const toggleSection = (phaseId, sectionIndex) => {
                const key = `${phaseId}-${sectionIndex}`;
                setExpandedSections(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const expandAll = () => {
                const expanded = {};
                allSectionKeys.forEach(key => expanded[key] = true);
                setExpandedSections(expanded);
            };

            const collapseAll = () => {
                setExpandedSections({});
            };

            const toggleCheck = (phaseId, sectionIndex, questionIndex) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setCheckedItems(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const updateNote = (phaseId, sectionIndex, questionIndex, value) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setNotes(prev => ({
                    ...prev,
                    [key]: value
                }));
            };

            const updateCodeSnippet = (phaseId, sectionIndex, questionIndex, value) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setCodeSnippets(prev => ({
                    ...prev,
                    [key]: value
                }));
            };

            const updateDiagram = (phaseId, sectionIndex, questionIndex, value) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setDiagrams(prev => ({
                    ...prev,
                    [key]: value
                }));
            };

            const setActiveTab = (phaseId, sectionIndex, questionIndex, tab) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setActiveTabs(prev => ({
                    ...prev,
                    [key]: tab
                }));
            };

            const addReference = () => {
                if (newReference.url.trim()) {
                    setReferences(prev => [...prev, {
                        ...newReference,
                        id: Date.now(),
                        title: newReference.title.trim() || newReference.url
                    }]);
                    setNewReference({ title: '', url: '' });
                }
            };

            const removeReference = (id) => {
                setReferences(prev => prev.filter(r => r.id !== id));
            };

            const calculateProgress = () => {
                const totalQuestions = framework.reduce((acc, phase) =>
                    acc + phase.sections.reduce((sAcc, section) => sAcc + section.questions.length, 0), 0
                );
                const checkedCount = Object.values(checkedItems).filter(Boolean).length;
                return Math.round((checkedCount / totalQuestions) * 100);
            };

            const resetProgress = () => {
                if (window.confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                    setCheckedItems({});
                    setNotes({});
                    setCodeSnippets({});
                    setDiagrams({});
                    setActiveTabs({});
                    setProjectName('');
                    setExpandedSections({});
                    setStakeholders([]);
                    setReferences([]);
                    localStorage.removeItem(STORAGE_KEY);
                }
            };

            const addStakeholder = () => {
                if (newStakeholder.name.trim()) {
                    setStakeholders(prev => [...prev, { ...newStakeholder, id: Date.now() }]);
                    setNewStakeholder({ name: '', role: '' });
                }
            };

            const removeStakeholder = (id) => {
                setStakeholders(prev => prev.filter(s => s.id !== id));
            };

            const exportNotes = () => {
                let markdown = `# Architecture Framework: ${projectName || 'Untitled Project'}\n\n`;
                markdown += `**Progress**: ${calculateProgress()}%\n\n`;
                markdown += `**Date**: ${new Date().toLocaleDateString()}\n\n`;

                if (stakeholders.length > 0) {
                    markdown += `## Stakeholders\n\n`;
                    markdown += `| Name | Role |\n|------|------|\n`;
                    stakeholders.forEach(s => {
                        markdown += `| ${s.name} | ${s.role || '-'} |\n`;
                    });
                    markdown += `\n`;
                }

                if (references.length > 0) {
                    markdown += `## References\n\n`;
                    references.forEach(r => {
                        markdown += `- [${r.title}](${r.url})\n`;
                    });
                    markdown += `\n`;
                }

                markdown += `---\n\n`;

                framework.forEach(phase => {
                    markdown += `## ${phase.number}. ${phase.phase}\n\n`;
                    markdown += `> ${phase.description}\n\n`;
                    phase.sections.forEach((section, sIndex) => {
                        markdown += `### ${section.title}\n\n`;
                        if (section.description) {
                            markdown += `*${section.description}*\n\n`;
                        }
                        section.questions.forEach((questionItem, qIndex) => {
                            const key = `${phase.id}-${sIndex}-${qIndex}`;
                            const isChecked = checkedItems[key];
                            const note = notes[key];
                            const code = codeSnippets[key];
                            const diagram = diagrams[key];
                            const questionText = typeof questionItem === 'string' ? questionItem : questionItem.q;
                            markdown += `- [${isChecked ? 'x' : ' '}] ${questionText}\n`;
                            if (note) {
                                markdown += `\n  **Answer**: ${note}\n\n`;
                            }
                            if (code) {
                                markdown += `\n  **Code**:\n  \`\`\`\n${code.split('\n').map(l => '  ' + l).join('\n')}\n  \`\`\`\n\n`;
                            }
                            if (diagram) {
                                markdown += `\n  **Diagram**:\n  \`\`\`mermaid\n${diagram.split('\n').map(l => '  ' + l).join('\n')}\n  \`\`\`\n\n`;
                            }
                        });
                        markdown += `\n`;
                    });
                });

                const blob = new Blob([markdown], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `architecture-framework-${projectName.replace(/\s+/g, '-').toLowerCase() || 'project'}.md`;
                a.click();
                URL.revokeObjectURL(url);
            };

            const totalQuestions = framework.reduce((acc, phase) =>
                acc + phase.sections.reduce((sAcc, section) => sAcc + section.questions.length, 0), 0
            );

            return (
                <div className={`min-h-screen transition-colors duration-300 ${darkMode ? 'dark bg-zinc-950' : 'bg-zinc-50'}`}>
                    <div className="flex">
                        {/* Sidebar */}
                        <div className={`hidden lg:flex lg:flex-col lg:w-72 lg:fixed lg:inset-y-0 border-r transition-colors duration-300 ${darkMode ? 'bg-zinc-900 border-zinc-800' : 'bg-white border-zinc-200'}`}>
                            <div className="flex-1 flex flex-col overflow-y-auto p-5">
                                {/* Header */}
                                <div className="flex items-center justify-between mb-4">
                                    <h1 className={`text-lg font-semibold tracking-tight ${darkMode ? 'text-zinc-100' : 'text-zinc-900'}`}>
                                        Architecture Framework
                                    </h1>
                                    <button
                                        onClick={() => setDarkMode(!darkMode)}
                                        className={`p-1.5 rounded-lg transition-colors ${darkMode ? 'hover:bg-zinc-800 text-zinc-400' : 'hover:bg-zinc-100 text-zinc-600'}`}
                                        aria-label="Toggle dark mode"
                                    >
                                        {darkMode ? <Sun size={16} /> : <Moon size={16} />}
                                    </button>
                                </div>

                                {/* Description */}
                                <p className={`text-xs leading-relaxed mb-5 ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>
                                    A structured checklist to guide system design decisions. Work through each phase, check off questions as you answer them, and add notes to document your decisions. Export your progress as Markdown when done.
                                </p>

                                {/* Progress */}
                                <div className="flex justify-center mb-6">
                                    <ProgressRing progress={calculateProgress()} darkMode={darkMode} size={100} />
                                </div>

                                {/* Project Name */}
                                <div className="mb-5">
                                    <label className={`block text-xs font-medium mb-1.5 ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>Project Name</label>
                                    <input
                                        type="text"
                                        placeholder="Enter project name..."
                                        value={projectName}
                                        onChange={(e) => setProjectName(e.target.value)}
                                        className={`w-full px-3 py-2 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                    />
                                </div>

                                {/* Stakeholders */}
                                <div className="mb-5">
                                    <div className="flex items-center gap-2 mb-3">
                                        <Users size={14} className={darkMode ? 'text-zinc-500' : 'text-zinc-400'} />
                                        <span className={`text-xs font-medium ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>Stakeholders</span>
                                    </div>

                                    {stakeholders.length > 0 && (
                                        <div className="mb-3 space-y-1.5">
                                            {stakeholders.map((s) => (
                                                <div key={s.id} className={`flex items-center justify-between px-2.5 py-1.5 rounded-lg text-sm ${darkMode ? 'bg-zinc-800' : 'bg-zinc-50'}`}>
                                                    <div className="flex-1 min-w-0 truncate">
                                                        <span className={`font-medium ${darkMode ? 'text-zinc-200' : 'text-zinc-800'}`}>{s.name}</span>
                                                        {s.role && (
                                                            <span className={`ml-1.5 text-xs ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>· {s.role}</span>
                                                        )}
                                                    </div>
                                                    <button
                                                        onClick={() => removeStakeholder(s.id)}
                                                        className={`p-0.5 rounded transition-colors ${darkMode ? 'hover:bg-zinc-700 text-zinc-600' : 'hover:bg-zinc-200 text-zinc-400'}`}
                                                    >
                                                        <X size={12} />
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    <div className="space-y-2">
                                        <input
                                            type="text"
                                            placeholder="Name"
                                            value={newStakeholder.name}
                                            onChange={(e) => setNewStakeholder(prev => ({ ...prev, name: e.target.value }))}
                                            onKeyDown={(e) => e.key === 'Enter' && addStakeholder()}
                                            className={`w-full px-2.5 py-1.5 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                        />
                                        <div className="flex gap-2">
                                            <input
                                                type="text"
                                                placeholder="Role (optional)"
                                                value={newStakeholder.role}
                                                onChange={(e) => setNewStakeholder(prev => ({ ...prev, role: e.target.value }))}
                                                onKeyDown={(e) => e.key === 'Enter' && addStakeholder()}
                                                className={`flex-1 px-2.5 py-1.5 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                            />
                                            <button
                                                onClick={addStakeholder}
                                                className={`px-2.5 py-1.5 rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-300' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-700'}`}
                                            >
                                                <Plus size={16} />
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                {/* References */}
                                <div className="mb-5">
                                    <div className="flex items-center gap-2 mb-3">
                                        <Link2 size={14} className={darkMode ? 'text-zinc-500' : 'text-zinc-400'} />
                                        <span className={`text-xs font-medium ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>References</span>
                                    </div>

                                    {references.length > 0 && (
                                        <div className="mb-3 space-y-1.5">
                                            {references.map((r) => (
                                                <div key={r.id} className={`flex items-center justify-between px-2.5 py-1.5 rounded-lg text-sm ${darkMode ? 'bg-zinc-800' : 'bg-zinc-50'}`}>
                                                    <a
                                                        href={r.url}
                                                        target="_blank"
                                                        rel="noopener noreferrer"
                                                        className={`flex-1 min-w-0 truncate flex items-center gap-1.5 ${darkMode ? 'text-zinc-300 hover:text-zinc-100' : 'text-zinc-700 hover:text-zinc-900'}`}
                                                    >
                                                        <ExternalLink size={12} className="flex-shrink-0" />
                                                        <span className="truncate">{r.title}</span>
                                                    </a>
                                                    <button
                                                        onClick={() => removeReference(r.id)}
                                                        className={`p-0.5 rounded transition-colors ml-2 ${darkMode ? 'hover:bg-zinc-700 text-zinc-600' : 'hover:bg-zinc-200 text-zinc-400'}`}
                                                    >
                                                        <X size={12} />
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    <div className="space-y-2">
                                        <input
                                            type="text"
                                            placeholder="Title (optional)"
                                            value={newReference.title}
                                            onChange={(e) => setNewReference(prev => ({ ...prev, title: e.target.value }))}
                                            className={`w-full px-2.5 py-1.5 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                        />
                                        <div className="flex gap-2">
                                            <input
                                                type="url"
                                                placeholder="URL"
                                                value={newReference.url}
                                                onChange={(e) => setNewReference(prev => ({ ...prev, url: e.target.value }))}
                                                onKeyDown={(e) => e.key === 'Enter' && addReference()}
                                                className={`flex-1 px-2.5 py-1.5 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                            />
                                            <button
                                                onClick={addReference}
                                                className={`px-2.5 py-1.5 rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-300' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-700'}`}
                                            >
                                                <Plus size={16} />
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                {/* Spacer */}
                                <div className="flex-1" />

                                {/* Controls */}
                                <div className="space-y-2">
                                    <button
                                        onClick={exportNotes}
                                        className={`w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-300' : 'bg-zinc-900 hover:bg-zinc-800 text-white'}`}
                                    >
                                        <Download size={16} />
                                        <span>Export Markdown</span>
                                    </button>

                                    <div className="flex gap-2">
                                        <button
                                            onClick={expandAll}
                                            className={`flex-1 flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-400' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-600'}`}
                                        >
                                            <ChevronsDown size={14} />
                                            <span>Expand</span>
                                        </button>
                                        <button
                                            onClick={collapseAll}
                                            className={`flex-1 flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-400' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-600'}`}
                                        >
                                            <ChevronsUp size={14} />
                                            <span>Collapse</span>
                                        </button>
                                    </div>

                                    <button
                                        onClick={resetProgress}
                                        className={`w-full flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ${darkMode ? 'hover:bg-zinc-800 text-zinc-600' : 'hover:bg-zinc-100 text-zinc-400'}`}
                                    >
                                        <RotateCcw size={12} />
                                        <span>Reset Progress</span>
                                    </button>

                                    {lastSaved && (
                                        <div className={`flex items-center justify-center gap-1 text-xs ${darkMode ? 'text-zinc-600' : 'text-zinc-400'}`}>
                                            <Save size={10} />
                                            <span>Auto-saved</span>
                                        </div>
                                    )}

                                    <a
                                        href="https://github.com/adibhanna/arch.github.io"
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className={`flex items-center justify-center gap-1.5 text-xs mt-4 ${darkMode ? 'text-zinc-600 hover:text-zinc-400' : 'text-zinc-400 hover:text-zinc-600'}`}
                                    >
                                        <Github size={14} />
                                        <span>View on GitHub</span>
                                    </a>
                                </div>
                            </div>
                        </div>

                        {/* Main Content */}
                        <div className="flex-1 lg:pl-72">
                            {/* Mobile Header */}
                            <div className={`lg:hidden sticky top-0 z-10 p-4 border-b transition-colors duration-300 ${darkMode ? 'bg-zinc-900 border-zinc-800' : 'bg-white border-zinc-200'}`}>
                                <div className="flex items-center justify-between">
                                    <h1 className={`text-lg font-semibold ${darkMode ? 'text-zinc-100' : 'text-zinc-900'}`}>
                                        Architecture Framework
                                    </h1>
                                    <div className="flex items-center gap-2">
                                        <span className={`text-sm font-medium ${darkMode ? 'text-zinc-400' : 'text-zinc-600'}`}>{calculateProgress()}%</span>
                                        <button
                                            onClick={() => setDarkMode(!darkMode)}
                                            className={`p-1.5 rounded-lg transition-colors ${darkMode ? 'hover:bg-zinc-800 text-zinc-400' : 'hover:bg-zinc-100 text-zinc-600'}`}
                                        >
                                            {darkMode ? <Sun size={16} /> : <Moon size={16} />}
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div className="p-4 sm:p-6 lg:p-8">
                                {/* Phases */}
                                <div className="space-y-4 max-w-4xl">
                                    {framework.map((phase) => {
                                        const phaseChecked = phase.sections.reduce((acc, section, sIndex) => {
                                            return acc + section.questions.filter((_, qIndex) =>
                                                checkedItems[`${phase.id}-${sIndex}-${qIndex}`]
                                            ).length;
                                        }, 0);
                                        const phaseTotal = phase.sections.reduce((acc, section) => acc + section.questions.length, 0);

                                        return (
                                            <div key={phase.id} className={`rounded-2xl border overflow-hidden transition-colors duration-300 hover-lift ${darkMode ? 'bg-zinc-900 border-zinc-800' : 'bg-white border-zinc-200'}`}>
                                                {/* Phase Header */}
                                                <div className={`px-5 py-4 border-b ${darkMode ? 'border-zinc-800' : 'border-zinc-100'}`}>
                                                    <div className="flex items-start justify-between gap-4">
                                                        <div className="flex items-start gap-3">
                                                            <span className={`text-2xl font-semibold tabular-nums ${darkMode ? 'text-zinc-700' : 'text-zinc-300'}`}>{phase.number}</span>
                                                            <div className="flex-1">
                                                                <h2 className={`text-base font-semibold ${darkMode ? 'text-zinc-100' : 'text-zinc-900'}`}>
                                                                    {phase.phase}
                                                                </h2>
                                                                <p className={`text-sm mt-1 leading-relaxed ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>
                                                                    {phase.description}
                                                                </p>
                                                            </div>
                                                        </div>
                                                        <div className={`text-sm font-medium tabular-nums px-2 py-0.5 rounded-md ${darkMode ? 'bg-zinc-800 text-zinc-400' : 'bg-zinc-100 text-zinc-600'}`}>
                                                            {phaseChecked}/{phaseTotal}
                                                        </div>
                                                    </div>
                                                </div>

                                                {/* Sections */}
                                                <div className={`divide-y ${darkMode ? 'divide-zinc-800' : 'divide-zinc-100'}`}>
                                                    {phase.sections.map((section, sIndex) => {
                                                        const sectionKey = `${phase.id}-${sIndex}`;
                                                        const isExpanded = expandedSections[sectionKey];
                                                        const sectionChecked = section.questions.filter((_, qIndex) =>
                                                            checkedItems[`${phase.id}-${sIndex}-${qIndex}`]
                                                        ).length;

                                                        return (
                                                            <div key={sIndex}>
                                                                <button
                                                                    onClick={() => toggleSection(phase.id, sIndex)}
                                                                    className={`w-full px-5 py-3 flex items-center justify-between transition-colors ${darkMode ? 'hover:bg-zinc-800/50' : 'hover:bg-zinc-50'}`}
                                                                >
                                                                    <div className="flex items-center gap-2.5">
                                                                        <ChevronDown
                                                                            size={14}
                                                                            className={`transition-transform duration-200 ${darkMode ? 'text-zinc-600' : 'text-zinc-400'} ${isExpanded ? 'rotate-0' : '-rotate-90'}`}
                                                                        />
                                                                        <h3 className={`text-sm font-medium ${darkMode ? 'text-zinc-300' : 'text-zinc-700'}`}>
                                                                            {section.title}
                                                                        </h3>
                                                                    </div>
                                                                    <div className="flex items-center gap-2.5">
                                                                        <div className={`w-12 h-1 rounded-full overflow-hidden ${darkMode ? 'bg-zinc-800' : 'bg-zinc-200'}`}>
                                                                            <div
                                                                                className={`h-full rounded-full transition-all duration-500 ${darkMode ? 'bg-zinc-600' : 'bg-zinc-500'}`}
                                                                                style={{ width: `${(sectionChecked / section.questions.length) * 100}%` }}
                                                                            />
                                                                        </div>
                                                                        <span className={`text-xs font-medium tabular-nums ${darkMode ? 'text-zinc-600' : 'text-zinc-400'}`}>
                                                                            {sectionChecked}/{section.questions.length}
                                                                        </span>
                                                                    </div>
                                                                </button>

                                                                {isExpanded && (
                                                                    <div className="px-5 pb-4 section-expand">
                                                                        {section.description && (
                                                                            <p className={`ml-6 mb-3 text-xs ${darkMode ? 'text-zinc-600' : 'text-zinc-400'}`}>
                                                                                {section.description}
                                                                            </p>
                                                                        )}
                                                                        <div className="space-y-2 ml-6">
                                                                            {section.questions.map((questionItem, qIndex) => {
                                                                                const itemKey = `${phase.id}-${sIndex}-${qIndex}`;
                                                                                const isChecked = checkedItems[itemKey];
                                                                                const note = notes[itemKey] || '';
                                                                                const code = codeSnippets[itemKey] || '';
                                                                                const diagram = diagrams[itemKey] || '';
                                                                                const activeTab = activeTabs[itemKey] || 'notes';
                                                                                const questionText = typeof questionItem === 'string' ? questionItem : questionItem.q;
                                                                                const questionTip = typeof questionItem === 'object' ? questionItem.tip : null;

                                                                                return (
                                                                                    <div key={qIndex} className={`p-3 rounded-lg transition-colors ${isChecked ? (darkMode ? 'bg-zinc-800/50' : 'bg-zinc-50') : ''}`}>
                                                                                        <div className="flex items-start gap-3">
                                                                                            <button
                                                                                                onClick={() => toggleCheck(phase.id, sIndex, qIndex)}
                                                                                                className="mt-0.5 flex-shrink-0 checkbox-custom"
                                                                                            >
                                                                                                {isChecked ? (
                                                                                                    <CheckCircle2 size={18} className={darkMode ? 'text-zinc-500' : 'text-zinc-600'} />
                                                                                                ) : (
                                                                                                    <Circle size={18} className={darkMode ? 'text-zinc-700 hover:text-zinc-600' : 'text-zinc-300 hover:text-zinc-400'} />
                                                                                                )}
                                                                                            </button>
                                                                                            <div className="flex-1 min-w-0">
                                                                                                <div className="flex items-start gap-1.5">
                                                                                                    <span className={`text-sm leading-relaxed ${isChecked ? (darkMode ? 'text-zinc-600' : 'text-zinc-400') : (darkMode ? 'text-zinc-300' : 'text-zinc-700')}`}>
                                                                                                        {questionText}
                                                                                                    </span>
                                                                                                    {questionTip && (
                                                                                                        <Tooltip content={questionTip} darkMode={darkMode}>
                                                                                                            <HelpCircle size={14} className={`flex-shrink-0 mt-0.5 ${darkMode ? 'text-zinc-600 hover:text-zinc-400' : 'text-zinc-400 hover:text-zinc-600'}`} />
                                                                                                        </Tooltip>
                                                                                                    )}
                                                                                                </div>

                                                                                                {/* Tabs */}
                                                                                                <div className="flex items-center gap-1 mt-2 mb-2">
                                                                                                    <button
                                                                                                        onClick={() => setActiveTab(phase.id, sIndex, qIndex, 'notes')}
                                                                                                        className={`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${activeTab === 'notes' ? (darkMode ? 'bg-zinc-700 text-zinc-200' : 'bg-zinc-200 text-zinc-800') : (darkMode ? 'text-zinc-500 hover:text-zinc-400' : 'text-zinc-500 hover:text-zinc-600')}`}
                                                                                                    >
                                                                                                        <FileText size={12} />
                                                                                                        <span>Notes</span>
                                                                                                    </button>
                                                                                                    <button
                                                                                                        onClick={() => setActiveTab(phase.id, sIndex, qIndex, 'code')}
                                                                                                        className={`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${activeTab === 'code' ? (darkMode ? 'bg-zinc-700 text-zinc-200' : 'bg-zinc-200 text-zinc-800') : (darkMode ? 'text-zinc-500 hover:text-zinc-400' : 'text-zinc-500 hover:text-zinc-600')}`}
                                                                                                    >
                                                                                                        <Code size={12} />
                                                                                                        <span>Code</span>
                                                                                                    </button>
                                                                                                    <button
                                                                                                        onClick={() => setActiveTab(phase.id, sIndex, qIndex, 'diagram')}
                                                                                                        className={`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${activeTab === 'diagram' ? (darkMode ? 'bg-zinc-700 text-zinc-200' : 'bg-zinc-200 text-zinc-800') : (darkMode ? 'text-zinc-500 hover:text-zinc-400' : 'text-zinc-500 hover:text-zinc-600')}`}
                                                                                                    >
                                                                                                        <GitBranch size={12} />
                                                                                                        <span>Diagram</span>
                                                                                                    </button>
                                                                                                </div>

                                                                                                {/* Notes Tab */}
                                                                                                {activeTab === 'notes' && (
                                                                                                    <textarea
                                                                                                        placeholder="Add notes..."
                                                                                                        value={note}
                                                                                                        onChange={(e) => updateNote(phase.id, sIndex, qIndex, e.target.value)}
                                                                                                        className={`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-500/20 resize-none transition-colors ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-300 placeholder:text-zinc-700' : 'bg-white border-zinc-200 text-zinc-700 placeholder:text-zinc-400'}`}
                                                                                                        rows="2"
                                                                                                    />
                                                                                                )}

                                                                                                {/* Code Tab */}
                                                                                                {activeTab === 'code' && (
                                                                                                    <textarea
                                                                                                        placeholder="Add code snippet..."
                                                                                                        value={code}
                                                                                                        onChange={(e) => updateCodeSnippet(phase.id, sIndex, qIndex, e.target.value)}
                                                                                                        className={`w-full px-3 py-2 text-sm font-mono border rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-500/20 resize-none transition-colors ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-300 placeholder:text-zinc-700' : 'bg-white border-zinc-200 text-zinc-700 placeholder:text-zinc-400'}`}
                                                                                                        rows="4"
                                                                                                    />
                                                                                                )}

                                                                                                {/* Diagram Tab */}
                                                                                                {activeTab === 'diagram' && (
                                                                                                    <div className="space-y-3">
                                                                                                        <textarea
                                                                                                            placeholder="Enter mermaid diagram code...&#10;&#10;Example:&#10;graph TD&#10;    A[Start] --> B[Process]&#10;    B --> C[End]"
                                                                                                            value={diagram}
                                                                                                            onChange={(e) => updateDiagram(phase.id, sIndex, qIndex, e.target.value)}
                                                                                                            className={`w-full px-3 py-2 text-sm font-mono border rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-500/20 resize-none transition-colors ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-300 placeholder:text-zinc-700' : 'bg-white border-zinc-200 text-zinc-700 placeholder:text-zinc-400'}`}
                                                                                                            rows="4"
                                                                                                        />
                                                                                                        {diagram && (
                                                                                                            <div className={`p-3 border rounded-lg overflow-auto ${darkMode ? 'bg-zinc-800 border-zinc-700' : 'bg-white border-zinc-200'}`}>
                                                                                                                <MermaidDiagram code={diagram} darkMode={darkMode} id={itemKey} />
                                                                                                            </div>
                                                                                                        )}
                                                                                                    </div>
                                                                                                )}
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                );
                                                                            })}
                                                                        </div>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>

                                <p className={`text-center text-xs mt-8 ${darkMode ? 'text-zinc-700' : 'text-zinc-400'}`}>
                                    {totalQuestions} questions across {framework.length} phases
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ArchitectureFramework />, document.getElementById('root'));
    </script>
</body>
</html>
