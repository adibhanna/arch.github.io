<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Architecture Framework</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', system-ui, sans-serif; }

        .progress-ring {
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-ring-circle {
            transition: stroke-dashoffset 0.5s ease;
        }

        .checkbox-custom {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .checkbox-custom:hover {
            transform: scale(1.1);
        }

        .section-expand {
            animation: expand 0.3s ease-out;
        }

        @keyframes expand {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hover-lift {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hover-lift:hover {
            transform: translateY(-1px);
        }

        .dark .hover-lift:hover {
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
        }

        .light .hover-lift:hover {
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Icons
        const CheckCircle2 = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
        );

        const Circle = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
            </svg>
        );

        const ChevronDown = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="6 9 12 15 18 9"/>
            </svg>
        );

        const Download = ({ size = 18, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
        );

        const Sun = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="4"/>
                <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
            </svg>
        );

        const Moon = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
        );

        const Plus = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M5 12h14"/><path d="M12 5v14"/>
            </svg>
        );

        const X = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
            </svg>
        );

        const Users = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>
            </svg>
        );

        const ChevronsDown = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m7 6 5 5 5-5"/><path d="m7 13 5 5 5-5"/>
            </svg>
        );

        const ChevronsUp = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m17 18-5-5-5 5"/><path d="m17 11-5-5-5 5"/>
            </svg>
        );

        const RotateCcw = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
            </svg>
        );

        const Save = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/>
            </svg>
        );

        const HelpCircle = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/>
            </svg>
        );

        const Github = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/>
            </svg>
        );

        const Link2 = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>
            </svg>
        );

        const Code = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>
            </svg>
        );

        const GitBranch = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="6" x2="6" y1="3" y2="15"/><circle cx="18" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><path d="M18 9a9 9 0 0 1-9 9"/>
            </svg>
        );

        const FileText = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/>
            </svg>
        );

        const ExternalLink = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/>
            </svg>
        );

        const Upload = ({ size = 20, className = "" }) => (
            <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/>
            </svg>
        );

        // Tooltip Component
        const Tooltip = ({ children, content, darkMode }) => {
            const [show, setShow] = useState(false);

            if (!content) return children;

            return (
                <div className="relative inline-flex">
                    <div
                        onMouseEnter={() => setShow(true)}
                        onMouseLeave={() => setShow(false)}
                        onClick={() => setShow(!show)}
                        className="cursor-help"
                    >
                        {children}
                    </div>
                    {show && (
                        <div className={`absolute z-50 left-6 top-0 w-64 p-3 text-xs rounded-lg shadow-lg border ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-300' : 'bg-white border-zinc-200 text-zinc-600'}`}>
                            {content}
                        </div>
                    )}
                </div>
            );
        };

        // Mermaid Diagram Component
        const MermaidDiagram = ({ code, darkMode, id }) => {
            const [svg, setSvg] = useState('');
            const [error, setError] = useState(null);

            useEffect(() => {
                if (!code.trim()) {
                    setSvg('');
                    setError(null);
                    return;
                }

                const renderDiagram = async () => {
                    try {
                        mermaid.initialize({
                            startOnLoad: false,
                            theme: darkMode ? 'dark' : 'default',
                            securityLevel: 'loose'
                        });
                        const { svg } = await mermaid.render(`mermaid-${id}`, code);
                        setSvg(svg);
                        setError(null);
                    } catch (e) {
                        setError(e.message || 'Invalid diagram syntax');
                        setSvg('');
                    }
                };

                renderDiagram();
            }, [code, darkMode, id]);

            if (!code.trim()) {
                return (
                    <div className={`text-xs ${darkMode ? 'text-zinc-600' : 'text-zinc-400'}`}>
                        Enter mermaid diagram code above to see preview
                    </div>
                );
            }

            if (error) {
                return (
                    <div className={`text-xs p-2 rounded ${darkMode ? 'bg-red-900/20 text-red-400' : 'bg-red-50 text-red-600'}`}>
                        {error}
                    </div>
                );
            }

            return (
                <div
                    className="mermaid-preview overflow-auto"
                    dangerouslySetInnerHTML={{ __html: svg }}
                />
            );
        };

        // Progress Ring Component
        const ProgressRing = ({ progress, size = 100, darkMode }) => {
            const strokeWidth = 6;
            const radius = (size - strokeWidth) / 2;
            const circumference = radius * 2 * Math.PI;
            const offset = circumference - (progress / 100) * circumference;

            return (
                <div className="relative inline-flex items-center justify-center">
                    <svg width={size} height={size} className="progress-ring">
                        <circle
                            className={darkMode ? "text-zinc-700" : "text-zinc-200"}
                            strokeWidth={strokeWidth}
                            stroke="currentColor"
                            fill="transparent"
                            r={radius}
                            cx={size / 2}
                            cy={size / 2}
                        />
                        <circle
                            className="progress-ring-circle"
                            strokeWidth={strokeWidth}
                            strokeDasharray={circumference}
                            strokeDashoffset={offset}
                            strokeLinecap="round"
                            stroke={darkMode ? "#a1a1aa" : "#52525b"}
                            fill="transparent"
                            r={radius}
                            cx={size / 2}
                            cy={size / 2}
                        />
                    </svg>
                    <div className="absolute flex flex-col items-center justify-center">
                        <span className={`text-2xl font-semibold ${darkMode ? 'text-zinc-100' : 'text-zinc-800'}`}>{progress}%</span>
                        <span className={`text-xs ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>complete</span>
                    </div>
                </div>
            );
        };

        const STORAGE_KEY = 'arch-framework-data';

        const ArchitectureFramework = () => {
            const [expandedSections, setExpandedSections] = useState({});
            const [checkedItems, setCheckedItems] = useState({});
            const [projectName, setProjectName] = useState('');
            const [notes, setNotes] = useState({});
            const [codeSnippets, setCodeSnippets] = useState({});
            const [diagrams, setDiagrams] = useState({});
            const [activeTabs, setActiveTabs] = useState({});
            const [stakeholders, setStakeholders] = useState([]);
            const [newStakeholder, setNewStakeholder] = useState({ name: '', role: '' });
            const [references, setReferences] = useState([]);
            const [newReference, setNewReference] = useState({ title: '', url: '' });
            const [lastSaved, setLastSaved] = useState(null);
            const [darkMode, setDarkMode] = useState(() => {
                if (typeof window !== 'undefined') {
                    const saved = localStorage.getItem('arch-framework-darkmode');
                    if (saved !== null) return JSON.parse(saved);
                    return window.matchMedia('(prefers-color-scheme: dark)').matches;
                }
                return false;
            });

            // Load from localStorage on mount
            useEffect(() => {
                try {
                    const saved = localStorage.getItem(STORAGE_KEY);
                    if (saved) {
                        const data = JSON.parse(saved);
                        if (data.checkedItems) setCheckedItems(data.checkedItems);
                        if (data.notes) setNotes(data.notes);
                        if (data.codeSnippets) setCodeSnippets(data.codeSnippets);
                        if (data.diagrams) setDiagrams(data.diagrams);
                        if (data.projectName) setProjectName(data.projectName);
                        if (data.expandedSections) setExpandedSections(data.expandedSections);
                        if (data.stakeholders) setStakeholders(data.stakeholders);
                        if (data.references) setReferences(data.references);
                        setLastSaved(new Date(data.savedAt));
                    }
                } catch (e) {
                    console.error('Failed to load saved data:', e);
                }
            }, []);

            // Save to localStorage on changes
            useEffect(() => {
                const timeoutId = setTimeout(() => {
                    try {
                        const data = {
                            checkedItems,
                            notes,
                            codeSnippets,
                            diagrams,
                            projectName,
                            expandedSections,
                            stakeholders,
                            references,
                            savedAt: new Date().toISOString()
                        };
                        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
                        setLastSaved(new Date());
                    } catch (e) {
                        console.error('Failed to save data:', e);
                    }
                }, 500);
                return () => clearTimeout(timeoutId);
            }, [checkedItems, notes, codeSnippets, diagrams, projectName, expandedSections, stakeholders, references]);

            useEffect(() => {
                document.documentElement.classList.toggle('dark', darkMode);
                localStorage.setItem('arch-framework-darkmode', JSON.stringify(darkMode));
            }, [darkMode]);

            const framework = [
                {
                    id: 'discovery',
                    phase: 'Discovery & Problem Definition',
                    number: '01',
                    description: 'Start by clearly defining the problem you\'re solving and understanding the constraints. This foundation prevents building the wrong thing and ensures alignment with business goals.',
                    sections: [
                        {
                            title: 'Problem Space',
                            description: 'Define the core problem and understand who you\'re building for.',
                            questions: [
                                { q: 'What problem are we solving? (One sentence)', tip: 'Force clarity by limiting to one sentence. If you can\'t explain it simply, you don\'t understand it well enough. This becomes your north star for all decisions.' },
                                { q: 'What happens if we build nothing?', tip: 'Understanding the cost of inaction helps prioritize and justify the project. Sometimes the answer reveals the problem isn\'t worth solving.' },
                                { q: 'Who are the primary users? Secondary users?', tip: 'Primary users are who you\'re optimizing for. Secondary users (admins, support staff) have different needs. Design for primary, accommodate secondary.' },
                                { q: 'What are their key pain points and frustrations?', tip: 'Focus on problems, not solutions. Users often ask for features when they really need outcomes. Dig deeper with "why" questions.' },
                                { q: 'What does success look like? How will we measure it?', tip: 'Define concrete, measurable outcomes. "Faster" isn\'t measurable; "reduce checkout time from 3 min to 30 sec" is. This prevents scope creep.' },
                                { q: 'What are the business goals and KPIs?', tip: 'Align technical decisions with business outcomes. Revenue, user growth, cost reduction, time-to-market—know which metrics matter most.' },
                                { q: 'Who are the key stakeholders? What are their priorities?', tip: 'Identify decision-makers, influencers, and blockers. Understanding their priorities helps navigate trade-offs and get buy-in.' },
                                { q: 'Are there competing solutions? What are their limitations?', tip: 'Study existing solutions (internal or external). Learn from their mistakes and identify opportunities for differentiation.' }
                            ]
                        },
                        {
                            title: 'Scope & Constraints',
                            description: 'Establish boundaries and identify limitations early.',
                            questions: [
                                { q: 'What\'s in scope for v1? What\'s explicitly out of scope?', tip: 'Write down what you WON\'T build. This prevents scope creep and sets expectations. "Out of scope" is as important as "in scope".' },
                                { q: 'What\'s the timeline? Are there hard deadlines?', tip: 'Distinguish between real deadlines (regulatory, contractual) and artificial ones. Hard deadlines constrain scope; soft deadlines can flex.' },
                                { q: 'What\'s the budget? (Infrastructure, team, tooling)', tip: 'Include all costs: cloud infrastructure, third-party services, team salaries, tooling licenses. Budget constraints drive build vs buy decisions.' },
                                { q: 'What existing systems must we integrate with?', tip: 'Legacy systems often dictate architecture choices. Understand their APIs, data formats, availability, and limitations upfront.' },
                                { q: 'Any regulatory/compliance requirements? (GDPR, HIPAA, SOC2, PCI-DSS)', tip: 'Compliance requirements affect data storage, encryption, audit logging, and geography. Retrofitting compliance is expensive—design for it.' },
                                { q: 'Any technical constraints? (Must use X, cannot use Y)', tip: 'Organizational standards, existing expertise, vendor relationships, or security policies may limit technology choices.' },
                                { q: 'What are the non-negotiable requirements vs nice-to-haves?', tip: 'Use MoSCoW (Must/Should/Could/Won\'t) or similar. This helps when you inevitably need to cut scope.' },
                                { q: 'Are there organizational or political constraints to consider?', tip: 'Team structures, reporting lines, budget ownership, and inter-team dynamics affect architecture. Conway\'s Law is real.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'requirements',
                    phase: 'Requirements Analysis',
                    number: '02',
                    description: 'Quantify your system\'s needs. Vague requirements lead to over-engineering or under-building. Get specific numbers for scale, performance, and reliability.',
                    sections: [
                        {
                            title: 'Scale & Performance',
                            description: 'Understand traffic patterns and growth projections to size your system correctly.',
                            questions: [
                                { q: 'Expected users: Day 1? Month 1? Year 1? Year 3?', tip: 'Get realistic projections, not optimistic marketing numbers. Design for Year 1 with a path to Year 3. Don\'t over-engineer for Day 1.' },
                                { q: 'Requests per second: Average? Peak? Burst capacity needed?', tip: 'Peak can be 10-100x average. Know your traffic shape. Burst capacity = handling sudden spikes without degradation.' },
                                { q: 'Data volume: Initial size? Daily growth rate? Total after 1 year?', tip: 'Calculate storage needs, backup costs, and query performance implications. Data grows faster than you expect.' },
                                { q: 'Latency requirements: P50? P95? P99? Hard limits?', tip: 'P50 is median, P99 is worst case for 99% of requests. User-facing usually needs P95 < 200ms. P99 catches tail latency issues.' },
                                { q: 'Throughput requirements: Reads/sec? Writes/sec?', tip: 'Read-heavy systems (100:1) vs write-heavy (1:1) need different architectures. This drives database and caching decisions.' },
                                { q: 'Geographic distribution: Single region? Multi-region? Global?', tip: 'Multi-region adds complexity and cost but improves latency and availability. Global requires careful data residency planning.' },
                                { q: 'Traffic patterns: Steady? Bursty? Predictable spikes? Seasonal?', tip: 'Bursty traffic needs auto-scaling. Predictable spikes (Black Friday) can be pre-scaled. Steady traffic is easiest to plan for.' },
                                { q: 'What are the expected concurrent users at peak?', tip: 'Concurrent users ≠ requests/sec. One user might make 10 requests. This affects connection pooling, session storage, and WebSocket capacity.' },
                                { q: 'Are there batch processing requirements? Volume? Frequency?', tip: 'Batch jobs compete for resources with real-time traffic. Schedule them during off-peak or use separate infrastructure.' }
                            ]
                        },
                        {
                            title: 'Availability & Reliability',
                            description: 'Define uptime targets and understand the cost of failures.',
                            questions: [
                                { q: 'Required uptime: 99%? 99.9%? 99.99%? 99.999%?', tip: '99% = 3.65 days downtime/year. 99.9% = 8.76 hours. 99.99% = 52.6 minutes. Each "nine" costs exponentially more.' },
                                { q: 'What\'s the acceptable downtime per month/year?', tip: 'Translate percentages to real time. 99.9% monthly = 43 minutes. Is that one 43-min outage or forty-three 1-min blips?' },
                                { q: 'Recovery Time Objective (RTO)? How fast must we recover?', tip: 'RTO is max acceptable downtime after a disaster. 4-hour RTO needs different infrastructure than 15-minute RTO.' },
                                { q: 'Recovery Point Objective (RPO)? How much data loss is acceptable?', tip: 'RPO is max acceptable data loss. Zero RPO requires synchronous replication. 1-hour RPO allows hourly backups.' },
                                { q: 'Can we have scheduled maintenance windows? When?', tip: 'Maintenance windows simplify operations but may not be acceptable for global 24/7 services. Plan for zero-downtime deployments if needed.' },
                                { q: 'What\'s the business cost of downtime per hour?', tip: 'Quantify in dollars: lost revenue, SLA penalties, customer churn, reputation damage. This justifies infrastructure investment.' },
                                { q: 'What SLAs do we need to offer to customers?', tip: 'External SLAs should be less aggressive than internal targets. Leave margin for error. SLA breaches have financial and legal consequences.' },
                                { q: 'Are there external dependencies with their own SLAs?', tip: 'Your availability can\'t exceed your dependencies\' availability. If a critical API offers 99.9%, you can\'t promise 99.99%.' },
                                { q: 'What\'s the acceptable error rate? (e.g., 0.1% of requests)', tip: 'Error budgets define acceptable failure. 0.1% error rate = 1 in 1000 requests can fail. This guides retry logic and alerting thresholds.' }
                            ]
                        },
                        {
                            title: 'Data Requirements',
                            description: 'Clarify consistency needs, access patterns, and data lifecycle.',
                            questions: [
                                { q: 'Strong consistency needed? Or eventual consistency OK? Where?', tip: 'Strong consistency = every read sees latest write. Eventual = reads may be stale temporarily. Financial data usually needs strong; social feeds can be eventual.' },
                                { q: 'Read-heavy or write-heavy workload? Ratio?', tip: 'Read-heavy (100:1) benefits from caching and read replicas. Write-heavy (1:1) needs careful database selection and write optimization.' },
                                { q: 'Data retention requirements? Legal minimums/maximums?', tip: 'Some data must be kept (audit logs, financial records). Some must be deleted (GDPR). Know the rules for each data type.' },
                                { q: 'Backup frequency needed? Full vs incremental?', tip: 'Full backups are slow but simple to restore. Incrementals are fast but complex. Frequency depends on RPO and data change rate.' },
                                { q: 'Any data sovereignty requirements? Data residency laws?', tip: 'Some countries require data to stay within borders (EU, China, Russia). This affects cloud region selection and replication strategy.' },
                                { q: 'PII or sensitive data involved? Classification levels?', tip: 'Classify data by sensitivity: public, internal, confidential, restricted. Each level has different encryption, access, and audit requirements.' },
                                { q: 'Real-time data needs vs batch processing acceptable?', tip: 'Real-time requires streaming architecture (Kafka, Kinesis). Batch is simpler and cheaper. Many use cases that seem real-time actually tolerate minutes of delay.' },
                                { q: 'Data archival strategy? Hot/warm/cold storage tiers?', tip: 'Hot = frequent access, high cost. Cold = rare access, low cost. Archive old data to reduce costs and improve query performance.' },
                                { q: 'Audit trail requirements? Immutability needs?', tip: 'Regulated industries need immutable audit logs. Consider append-only tables, write-once storage, or blockchain for tamper-proof records.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'data-modeling',
                    phase: 'Data & Domain Modeling',
                    number: '03',
                    description: 'Model your domain before writing code. Understanding entities, relationships, and boundaries prevents costly refactors and enables better service decomposition.',
                    sections: [
                        {
                            title: 'Core Entities',
                            description: 'Identify the key concepts and how they relate to each other.',
                            questions: [
                                { q: 'What are the main entities/concepts in the domain?', tip: 'List nouns from requirements: User, Order, Product, Payment. These become your tables/collections and often your services.' },
                                { q: 'What are the relationships between entities?', tip: 'Draw an entity-relationship diagram. User has many Orders, Order has many Products. Relationships drive join strategies and API design.' },
                                { q: 'Which entities are immutable? Which change frequently?', tip: 'Immutable data (events, audit logs) is easier to cache and replicate. Mutable data (user profiles) needs careful consistency handling.' },
                                { q: 'What\'s the cardinality? (1:1, 1:many, many:many)', tip: 'Cardinality affects table design. Many:many needs junction tables. High-cardinality relationships (user has 1M followers) need special handling.' },
                                { q: 'What are the access patterns for each entity?', tip: 'How will data be queried? By ID? By date range? Full-text search? Access patterns determine indexes and sometimes database choice.' },
                                { q: 'What\'s the source of truth for each entity?', tip: 'In distributed systems, one service owns each entity. Others get copies. This prevents conflicting updates and simplifies consistency.' },
                                { q: 'What are the key identifiers? Natural keys vs surrogate keys?', tip: 'Natural keys (email, SSN) have meaning but can change. Surrogate keys (UUID, auto-increment) are stable but meaningless. Often use both.' },
                                { q: 'What attributes are required vs optional?', tip: 'Required fields must be validated. Optional fields complicate queries (NULL handling). Minimize optional fields for cleaner data.' },
                                { q: 'Are there temporal aspects? (Versioning, history, effective dates)', tip: 'Do you need to query "what was the price on Jan 1"? Temporal data requires special schema design (valid_from, valid_to columns).' }
                            ]
                        },
                        {
                            title: 'Domain Boundaries',
                            description: 'Define logical separations that will guide your architecture.',
                            questions: [
                                { q: 'What are the logical domains/bounded contexts?', tip: 'From Domain-Driven Design: areas where terms have specific meaning. "Customer" means different things to Sales vs Support. Separate these.' },
                                { q: 'Which domains are core vs supporting vs generic?', tip: 'Core = competitive advantage, build it. Supporting = necessary but not differentiating. Generic = commodity, buy it (auth, payments).' },
                                { q: 'Where do domain boundaries align with team boundaries?', tip: 'Conway\'s Law: system structure mirrors org structure. Align boundaries with teams for clear ownership and reduced coordination.' },
                                { q: 'Which domains can evolve independently?', tip: 'Loosely coupled domains can be deployed separately. Tightly coupled ones must be coordinated. Aim for loose coupling.' },
                                { q: 'What events happen across domain boundaries?', tip: 'Events decouple domains. OrderPlaced, PaymentReceived, ShipmentSent. These become your integration contracts.' },
                                { q: 'Which domains have different consistency requirements?', tip: 'Payments need strong consistency. Recommendations can be eventually consistent. Don\'t apply the strictest requirement everywhere.' },
                                { q: 'Where are the transaction boundaries?', tip: 'Transactions within a domain are easy. Cross-domain transactions are hard (sagas, 2PC). Design to minimize cross-domain transactions.' },
                                { q: 'What data needs to be replicated across domains?', tip: 'Some data is needed everywhere (user info). Replicate via events or shared cache. Accept eventual consistency for replicated data.' }
                            ]
                        },
                        {
                            title: 'Data Storage Strategy',
                            description: 'Choose the right storage solutions for your data patterns.',
                            questions: [
                                { q: 'What database type fits each data pattern? (Relational, Document, Key-Value, Graph, Time-series)', tip: 'Relational for transactions, Document for flexible schemas, Key-Value for caching, Graph for relationships, Time-series for metrics. Match the tool to the problem.' },
                                { q: 'What indexing strategy is needed? Primary, secondary, composite indexes?', tip: 'Indexes speed reads but slow writes. Index columns used in WHERE, JOIN, ORDER BY. Composite indexes for multi-column queries.' },
                                { q: 'Partitioning/sharding strategy? By what key? How many partitions?', tip: 'Partition by a key that distributes evenly and matches query patterns. User ID for user data, timestamp for time-series. Start with few partitions.' },
                                { q: 'Denormalization trade-offs? Where is it worth it?', tip: 'Denormalization speeds reads by duplicating data. Worth it for hot read paths. Increases write complexity and storage. Don\'t denormalize prematurely.' },
                                { q: 'What are the query patterns? Simple lookups vs complex queries?', tip: 'Simple lookups = key-value or document store. Complex joins = relational. Analytics = columnar (BigQuery, Redshift). Match database to query pattern.' },
                                { q: 'Full-text search requirements? Which fields?', tip: 'Full-text search usually needs a dedicated engine (Elasticsearch, Algolia). Database full-text is limited but avoids another system.' },
                                { q: 'Caching strategy at the data layer? Cache-aside, write-through, write-behind?', tip: 'Cache-aside: app manages cache. Write-through: write to cache and DB. Write-behind: write to cache, async to DB. Each has consistency trade-offs.' },
                                { q: 'Data migration strategy from existing systems?', tip: 'Big bang (downtime) vs gradual (dual-write + backfill). Plan for rollback. Validate data integrity. Migration often takes longer than expected.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'api-design',
                    phase: 'API Design',
                    number: '04',
                    description: 'APIs are contracts. Design them carefully as they\'re hard to change once published. Consider consumers, versioning, and long-term evolution.',
                    sections: [
                        {
                            title: 'API Strategy',
                            description: 'Define your overall approach to API design.',
                            questions: [
                                { q: 'API style: REST? GraphQL? gRPC? Event-driven? Why?', tip: 'REST for simplicity and caching. GraphQL for flexible queries. gRPC for performance and streaming. Event-driven for async workflows. Choose based on use case.' },
                                { q: 'Who are the API consumers? Internal services? External partners? Public developers?', tip: 'Internal APIs can change faster. External APIs need stability, versioning, and documentation. Public APIs need rate limiting and abuse protection.' },
                                { q: 'Synchronous vs asynchronous communication? Where?', tip: 'Sync for immediate responses (user-facing). Async for long operations, decoupling, and reliability. Many systems use both.' },
                                { q: 'Request/response format: JSON? Protocol Buffers? XML?', tip: 'JSON for humans and web. Protocol Buffers for performance and type safety. XML for legacy enterprise. JSON is the safe default.' },
                                { q: 'API gateway needed? What functionality? (Auth, rate limiting, transformation)', tip: 'Gateways centralize cross-cutting concerns. Useful for auth, rate limiting, logging, and transforming legacy APIs. Adds latency and complexity.' },
                                { q: 'Service mesh requirements? (Istio, Linkerd, Consul)', tip: 'Service meshes handle service-to-service communication: mTLS, retries, circuit breakers. Valuable at scale but complex to operate.' },
                                { q: 'How will APIs be discovered? Service registry? API catalog?', tip: 'Service registries (Consul, Eureka) for runtime discovery. API catalogs for documentation and governance. Both matter at scale.' }
                            ]
                        },
                        {
                            title: 'API Contracts',
                            description: 'Define clear contracts and standards.',
                            questions: [
                                { q: 'How will APIs be documented? OpenAPI/Swagger? GraphQL schema?', tip: 'OpenAPI (Swagger) is the standard for REST. GraphQL is self-documenting. Good docs reduce support burden and improve developer experience.' },
                                { q: 'Naming conventions: URL structure, field names, error codes?', tip: 'Consistency matters more than the specific choice. Use plural nouns for resources (/users), camelCase or snake_case for fields, and standardized error codes.' },
                                { q: 'Pagination strategy: Cursor-based? Offset? Keyset?', tip: 'Offset is simple but slow for large datasets. Cursor-based is efficient and handles real-time data. Keyset is fast but requires a unique, sequential key.' },
                                { q: 'Filtering and sorting conventions?', tip: 'Define a consistent query parameter syntax. Common patterns: ?filter[status]=active, ?sort=-created_at. Consider GraphQL for complex filtering needs.' },
                                { q: 'Error handling: Error format? HTTP status codes? Error codes?', tip: 'Use appropriate HTTP status codes (4xx for client errors, 5xx for server). Include machine-readable error codes and human-readable messages. Be consistent.' },
                                { q: 'Idempotency requirements? Idempotency keys?', tip: 'Idempotent operations can be safely retried. Use idempotency keys (client-generated UUIDs) for POST requests to prevent duplicate processing.' },
                                { q: 'Request validation: Where? How strict?', tip: 'Validate at the edge (API gateway) for performance, and in the service for business rules. Be strict on input, lenient on output (Postel\'s law).' },
                                { q: 'Response envelope structure? Metadata? Links (HATEOAS)?', tip: 'Envelopes wrap data with metadata: {data: [], meta: {total, page}, links: {next, prev}}. HATEOAS provides discoverability but adds complexity.' }
                            ]
                        },
                        {
                            title: 'API Versioning & Evolution',
                            description: 'Plan for change without breaking consumers.',
                            questions: [
                                { q: 'Versioning strategy: URL path? Header? Query param?', tip: 'URL path (/v1/users) is most visible and cacheable. Header versioning is cleaner but harder to test. Pick one and be consistent.' },
                                { q: 'Breaking vs non-breaking change policy?', tip: 'Non-breaking: adding fields, new endpoints. Breaking: removing fields, changing types, renaming. Breaking changes require new versions.' },
                                { q: 'Deprecation process: Timeline? Communication? Sunset headers?', tip: 'Give consumers time (6-12 months typical). Use Sunset HTTP headers, email notifications, and dashboard warnings. Monitor usage before removal.' },
                                { q: 'Backward compatibility requirements: How many versions supported?', tip: 'Supporting multiple versions is expensive. Typically support N and N-1. Plan for eventual sunsetting from day one.' },
                                { q: 'How will you handle schema evolution?', tip: 'Use additive changes when possible. For breaking changes, consider transformation layers. Schema registries help with compatibility checking.' },
                                { q: 'Contract testing between services?', tip: 'Contract tests verify API agreements without full integration tests. Tools: Pact, Spring Cloud Contract. Catches breaking changes early.' },
                                { q: 'API changelog and migration guides?', tip: 'Maintain a changelog for every version. Provide migration guides for breaking changes with code examples. Automate where possible.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'architecture',
                    phase: 'Architecture Design',
                    number: '05',
                    description: 'Make deliberate choices about system structure and technology. Document trade-offs explicitly—every decision has costs and benefits.',
                    sections: [
                        {
                            title: 'System Structure',
                            description: 'Define how components are organized and communicate.',
                            questions: [
                                { q: 'Monolith, modular monolith, or microservices? Why?', tip: 'Monolith for small teams and simple domains. Modular monolith for growing teams. Microservices for independent scaling and deployment. Start simple, split later.' },
                                { q: 'What are the major components/services?', tip: 'List each component, its responsibility, and its boundaries. Each should do one thing well. Avoid circular dependencies between components.' },
                                { q: 'Which components are synchronous? Asynchronous?', tip: 'Sync for immediate responses needed. Async for long operations, decoupling, and better resilience. Payment processing often needs sync; email sending should be async.' },
                                { q: 'What are the external dependencies?', tip: 'List every external service: payment providers, email services, analytics, etc. Each is a potential point of failure. Plan for their outages.' },
                                { q: 'Single database or database per service? Why?', tip: 'Single DB is simpler but creates coupling. DB per service enables independence but complicates transactions. Start shared, split when needed.' },
                                { q: 'How do services communicate? HTTP? Message queues? Events?', tip: 'HTTP/REST for request-response. Message queues for reliable async. Events for decoupled pub-sub. Many systems use all three for different use cases.' },
                                { q: 'What\'s the deployment unit? (Container, function, VM)', tip: 'Containers (Docker) are the default choice. Functions for event-driven, intermittent workloads. VMs for legacy or special requirements.' },
                                { q: 'Serverless components? Where does it make sense?', tip: 'Serverless is great for variable traffic, event processing, and cron jobs. Less suitable for consistent load or long-running processes. Consider cold starts.' }
                            ]
                        },
                        {
                            title: 'Technology Choices',
                            description: 'Select tools and frameworks based on requirements, not trends.',
                            questions: [
                                { q: 'Primary programming language(s)? Why?', tip: 'Consider team expertise, ecosystem, performance needs, and hiring market. Boring technology is often the right choice. Polyglot has hidden costs.' },
                                { q: 'Framework choices? Why these over alternatives?', tip: 'Evaluate community support, documentation, long-term viability, and fit for your use case. Popular frameworks have more resources and easier hiring.' },
                                { q: 'Database(s): Which ones? Why? (PostgreSQL, MongoDB, Redis, etc.)', tip: 'PostgreSQL is the safe default for relational data. MongoDB for flexible schemas. Redis for caching. Choose based on data model and query patterns.' },
                                { q: 'Message queue/event bus: Which one? (Kafka, RabbitMQ, SQS, etc.)', tip: 'Kafka for high-throughput event streaming. RabbitMQ for complex routing. SQS for simple AWS-native queuing. Match complexity to needs.' },
                                { q: 'Search infrastructure: Elasticsearch? Algolia? Database full-text?', tip: 'Database full-text for simple needs. Elasticsearch for complex search and analytics. Algolia for instant search with minimal ops. Consider the operational burden.' },
                                { q: 'File/blob storage: S3? GCS? Azure Blob?', tip: 'Use your cloud provider\'s blob storage. S3 is the de facto standard. Consider CDN integration, lifecycle policies, and cross-region replication needs.' },
                                { q: 'CDN requirements? Which provider?', tip: 'CDNs improve latency for static assets and reduce origin load. CloudFront for AWS, Cloud CDN for GCP. Consider edge computing capabilities if needed.' },
                                { q: 'Infrastructure: AWS? GCP? Azure? On-prem? Multi-cloud?', tip: 'Pick one cloud and go deep. Multi-cloud adds complexity without proportional benefit for most. Consider existing contracts, team expertise, and specific service needs.' }
                            ]
                        },
                        {
                            title: 'Caching Strategy',
                            description: 'Design caching layers to optimize performance and reduce load.',
                            questions: [
                                { q: 'What layers need caching? (Browser, CDN, Application, Database)', tip: 'Cache at multiple layers. Browser caching for static assets. CDN for global distribution. Application cache for computed data. Database query cache for repeated queries.' },
                                { q: 'Cache technology: Redis? Memcached? In-memory?', tip: 'Redis is the versatile default (data structures, persistence, pub-sub). Memcached for simple key-value at scale. In-memory for single-instance apps.' },
                                { q: 'Cache invalidation strategy: TTL? Event-based? Manual?', tip: 'TTL is simplest but may serve stale data. Event-based is accurate but complex. Often combine: short TTL with event invalidation for critical data.' },
                                { q: 'Cache-aside, read-through, or write-through pattern?', tip: 'Cache-aside: app manages cache explicitly. Read-through: cache fetches on miss. Write-through: writes go to cache and DB. Cache-aside is most common.' },
                                { q: 'What\'s the cache hit ratio target?', tip: 'Aim for 80-95% hit ratio for application caches. Monitor this metric. Low hit ratio means cache isn\'t effective; very high might mean you\'re caching too much.' },
                                { q: 'Cache warming strategy for cold starts?', tip: 'Cold cache after deploy or restart hurts performance. Pre-populate critical data on startup. Consider lazy warming for less critical data.' },
                                { q: 'Distributed caching requirements? Consistency?', tip: 'Distributed caches need consistency strategy. Redis Cluster for sharding. Consider cache-stampede prevention (locking, probabilistic early expiration).' },
                                { q: 'Cache key design: Namespacing? Versioning?', tip: 'Include version in keys for easy invalidation: "v1:users:123". Use namespaces to avoid collisions. Keep keys short but descriptive.' }
                            ]
                        },
                        {
                            title: 'Trade-offs & Decisions',
                            description: 'Document the compromises you\'re making and why.',
                            questions: [
                                { q: 'Consistency vs Availability: Which did we prioritize? Why?', tip: 'CAP theorem: you can\'t have both during partitions. Most web apps choose availability. Financial systems often need consistency. Know your requirements.' },
                                { q: 'Simplicity vs Flexibility: Where did we compromise?', tip: 'Flexibility adds complexity. Simple solutions are easier to understand, maintain, and debug. Choose flexibility only where requirements demand it.' },
                                { q: 'Cost vs Performance: What\'s our optimization target?', tip: 'Define acceptable performance, then optimize for cost. Or define budget, then maximize performance. Know which constraint is harder.' },
                                { q: 'Time to market vs Perfect design: What\'s the balance?', tip: 'Perfect is the enemy of good. Ship something that works, then iterate. But avoid decisions that are expensive to reverse later.' },
                                { q: 'Build vs Buy: What are we building? What are we buying?', tip: 'Build core differentiators. Buy commodity features (auth, payments, email). Building everything is slow; buying everything is inflexible.' },
                                { q: 'What technical debt are we intentionally accepting?', tip: 'Document known shortcuts and why. Technical debt is a tool—sometimes the right choice. Unknown debt is dangerous; known debt is manageable.' },
                                { q: 'What are the key architectural decision records (ADRs)?', tip: 'ADRs document significant decisions, context, and rationale. Future you will thank present you. Include what was considered and rejected.' },
                                { q: 'What would we do differently with more time/budget?', tip: 'This reveals what you\'re compromising on. Revisit this list periodically. Some shortcuts become permanent; plan accordingly.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'testing',
                    phase: 'Testing Strategy',
                    number: '06',
                    description: 'Define how you\'ll verify the system works correctly. A comprehensive testing strategy catches bugs early and enables confident deployments.',
                    sections: [
                        {
                            title: 'Test Pyramid',
                            description: 'Plan your testing layers and coverage targets.',
                            questions: [
                                { q: 'Unit test coverage target? What\'s worth unit testing?', tip: 'Aim for 70-80% coverage on business logic. Test complex algorithms, edge cases, and calculations. Don\'t test simple getters/setters or framework code.' },
                                { q: 'Integration test strategy: What integrations to test?', tip: 'Test database operations, API contracts, and external service integrations. Use real databases in CI when possible. Mock only what you must.' },
                                { q: 'End-to-end test coverage: Critical user journeys?', tip: 'E2E tests are slow and flaky—use sparingly. Cover critical paths: signup, checkout, core workflows. Aim for 5-20 critical journey tests, not hundreds.' },
                                { q: 'Contract testing between services?', tip: 'Contract tests verify API agreements without full integration. Essential for microservices. Tools: Pact, Spring Cloud Contract. Run in CI on every PR.' },
                                { q: 'What testing frameworks and tools?', tip: 'Pick well-supported tools for your stack. Jest/Vitest for JS, pytest for Python, JUnit for Java. Consistency across the team matters more than the specific tool.' },
                                { q: 'Test data management: Fixtures? Factories? Production snapshots?', tip: 'Factories (faker data) for unit tests. Fixtures for integration tests. Sanitized production snapshots for realistic E2E. Never use real PII in tests.' },
                                { q: 'Mocking strategy: What to mock? What to test against real services?', tip: 'Mock external services and slow dependencies. Test against real databases and your own services when possible. Over-mocking hides bugs.' },
                                { q: 'Code coverage requirements? Coverage tools?', tip: 'Coverage is a guide, not a goal. High coverage with bad tests is worse than lower coverage with good tests. Track trends, not absolute numbers.' }
                            ]
                        },
                        {
                            title: 'Performance & Load Testing',
                            description: 'Verify the system meets performance requirements.',
                            questions: [
                                { q: 'Load testing approach: Tools? (k6, Gatling, Locust, JMeter)', tip: 'k6 for modern JS-based tests. Gatling for Scala. Locust for Python. JMeter for GUI-based. Choose based on team skills and CI integration needs.' },
                                { q: 'Performance benchmarks: What latency targets?', tip: 'Define P50, P95, P99 targets for each endpoint. User-facing APIs typically need P95 < 200ms. Batch APIs can be slower. Measure from client perspective.' },
                                { q: 'Stress testing: How far beyond normal load?', tip: 'Test at 2x, 5x, 10x expected load. Find the breaking point. Understand degradation behavior. Is it graceful or catastrophic?' },
                                { q: 'Soak testing: Long-running stability tests?', tip: 'Run at normal load for hours or days. Catches memory leaks, connection pool exhaustion, and gradual degradation. Run weekly or before major releases.' },
                                { q: 'Capacity planning: How to determine scaling thresholds?', tip: 'Identify the bottleneck at each scale level. CPU-bound? Memory? Database connections? I/O? Set scaling triggers below the breaking point.' },
                                { q: 'Performance regression testing in CI/CD?', tip: 'Run lightweight perf tests on every PR. Compare against baseline. Alert on significant regressions. Full load tests on a schedule (nightly/weekly).' },
                                { q: 'Database query performance testing?', tip: 'Test queries with production-like data volumes. Small test datasets hide N+1 queries and missing indexes. Use query analyzers (EXPLAIN ANALYZE).' },
                                { q: 'Third-party dependency performance impact?', tip: 'External APIs add latency and variability. Test with realistic latency injection. Have fallbacks for when dependencies are slow.' }
                            ]
                        },
                        {
                            title: 'Specialized Testing',
                            description: 'Additional testing for specific quality attributes.',
                            questions: [
                                { q: 'Security testing: SAST? DAST? Penetration testing schedule?', tip: 'SAST (static analysis) in CI for every PR. DAST (dynamic testing) on deployed environments. Professional pen testing annually or after major changes.' },
                                { q: 'Accessibility testing: WCAG compliance level? Tools?', tip: 'Target WCAG 2.1 AA minimum. Use axe, Lighthouse, or Pa11y in CI. Manual testing with screen readers for critical flows. Legal requirements vary by region.' },
                                { q: 'Chaos engineering: Failure injection testing? (Chaos Monkey, Gremlin)', tip: 'Start simple: kill random pods, inject latency, simulate outages. Chaos Monkey for random instance termination. Gremlin for controlled experiments. Start in staging.' },
                                { q: 'Data integrity testing: Consistency checks?', tip: 'Verify referential integrity, business rule invariants, and data consistency across systems. Run reconciliation jobs regularly. Alert on anomalies.' },
                                { q: 'Backup/restore testing: How often verified?', tip: 'Test restores quarterly at minimum. Untested backups are not backups. Measure restore time. Document the process. Practice under pressure.' },
                                { q: 'Disaster recovery drills: Frequency? Scope?', tip: 'Run DR drills annually at minimum. Start with tabletop exercises, progress to full failovers. Include the whole team. Document lessons learned.' },
                                { q: 'Browser/device compatibility testing matrix?', tip: 'Define supported browsers and versions. Test top 3-5 browser/OS combinations. Use BrowserStack or Sauce Labs for coverage. Mobile testing is essential.' },
                                { q: 'API compatibility testing for breaking changes?', tip: 'Maintain a suite of consumer tests. Run against new versions before release. Breaking changes should fail CI. Communicate changes via changelog.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'cicd',
                    phase: 'CI/CD & Deployment',
                    number: '07',
                    description: 'Automate your path to production. Good CI/CD practices enable fast, reliable, and safe deployments.',
                    sections: [
                        {
                            title: 'Build & Integration',
                            description: 'Define your continuous integration pipeline.',
                            questions: [
                                { q: 'CI platform: GitHub Actions? GitLab CI? Jenkins? CircleCI?', tip: 'GitHub Actions if you\'re on GitHub—great integration. GitLab CI for GitLab. Jenkins for maximum flexibility but high maintenance. Choose based on your git host.' },
                                { q: 'Build pipeline stages: Lint, test, build, scan, publish?', tip: 'Fail fast: lint first (fastest), then unit tests, then integration tests, then build, then security scan. Each stage should be independently cacheable.' },
                                { q: 'Build time target? Current build time?', tip: 'Target < 10 minutes for PR builds, < 20 for full builds. Slow builds kill productivity. Parallelize tests, use caching aggressively, consider build splitting.' },
                                { q: 'Artifact management: Container registry? Package registry?', tip: 'Use your cloud provider\'s registry or Docker Hub. Tag with git SHA and semantic version. Implement retention policies. Scan images for vulnerabilities.' },
                                { q: 'Dependency scanning: Vulnerabilities? License compliance?', tip: 'Scan dependencies in every build. Tools: Snyk, Dependabot, npm audit. Block high/critical vulnerabilities. Track license compliance for legal requirements.' },
                                { q: 'Code quality gates: Coverage? Complexity? Duplication?', tip: 'Set minimum standards but don\'t over-constrain. Coverage thresholds (e.g., no decrease), complexity limits, and duplication checks. Quality gates should guide, not block.' },
                                { q: 'Branch strategy: GitFlow? Trunk-based? GitHub Flow?', tip: 'Trunk-based for mature teams with good CI. GitHub Flow for most teams (feature branches + main). GitFlow is complex—only if you need it.' },
                                { q: 'Merge requirements: Reviews? CI passing? Approvals?', tip: 'Require at least one review and passing CI. For sensitive areas, require specific approvers (CODEOWNERS). Balance speed with safety.' }
                            ]
                        },
                        {
                            title: 'Deployment Strategy',
                            description: 'Define how changes reach production.',
                            questions: [
                                { q: 'Deployment frequency target: Daily? Weekly? Continuous?', tip: 'More frequent = smaller changes = lower risk. Target at least weekly. Elite teams deploy multiple times daily. Frequency indicates CI/CD maturity.' },
                                { q: 'Deployment strategy: Rolling? Blue-green? Canary? Feature flags?', tip: 'Rolling for stateless services. Blue-green for instant rollback. Canary for gradual rollout with monitoring. Feature flags for decoupling deploy from release.' },
                                { q: 'Environment progression: Dev → Staging → Production?', tip: 'Each environment should match production as closely as possible. Staging should have production-like data and config. Catch issues before they reach prod.' },
                                { q: 'Infrastructure as Code: Terraform? CloudFormation? Pulumi?', tip: 'Terraform for multi-cloud or cloud-agnostic. CloudFormation for AWS-only. Pulumi for programming language approach. IaC is essential—no manual infra changes.' },
                                { q: 'Container orchestration: Kubernetes? ECS? Nomad?', tip: 'Kubernetes is the standard but complex. ECS is simpler for AWS. Nomad is lightweight alternative. Match complexity to team capability.' },
                                { q: 'Database migration strategy: How applied? Rollback plan?', tip: 'Migrations should be backward compatible. Apply before deploying new code. Test rollback path. Tools: Flyway, Alembic, Rails migrations.' },
                                { q: 'Configuration management: Environment variables? Secrets manager?', tip: 'Environment variables for non-sensitive config. Secrets manager (AWS Secrets Manager, HashiCorp Vault) for sensitive data. Never commit secrets.' },
                                { q: 'Deployment approval process: Manual gates? Automated?', tip: 'Automate as much as possible. Manual gates for production if required by compliance. Keep approval friction low or teams will work around it.' }
                            ]
                        },
                        {
                            title: 'Release Management',
                            description: 'Control and manage releases safely.',
                            questions: [
                                { q: 'Feature flags system: LaunchDarkly? Unleash? Custom?', tip: 'LaunchDarkly for enterprise features. Unleash is open source. Custom is fine for simple needs. Feature flags enable safe deployment of incomplete features.' },
                                { q: 'Rollback strategy: Automated? Manual? Time to rollback?', tip: 'Aim for < 5 minute rollback. Automated rollback on health check failures. Keep previous version deployable. Practice rollbacks regularly.' },
                                { q: 'Hotfix process: Emergency deployment path?', tip: 'Hotfixes should bypass some gates but not all. Direct-to-production branch with expedited review. Document what was skipped. Backport to main branch.' },
                                { q: 'Release notes: Automated generation? Changelog format?', tip: 'Generate from commit messages or PR descriptions. Keep a Changelog format is standard. Automate with tools like semantic-release or release-please.' },
                                { q: 'Deployment windows: Any restricted times?', tip: 'Avoid deploying before weekends or holidays. Define freeze periods for high-traffic events. Consider time zones for global teams.' },
                                { q: 'Smoke tests post-deployment: What\'s verified?', tip: 'Run critical path tests immediately after deploy. Health checks, key user journeys, critical integrations. Automated smoke tests enable faster feedback.' },
                                { q: 'Deployment metrics: Success rate? Frequency? Lead time?', tip: 'Track DORA metrics: deployment frequency, lead time, change failure rate, MTTR. These indicate CI/CD health. Aim for elite performance over time.' },
                                { q: 'Progressive rollout: Percentage-based? User segment-based?', tip: 'Start with 1-5% of traffic, monitor, then expand. User segment rollouts (beta users, employees first) for new features. Automate promotion based on metrics.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'resilience',
                    phase: 'Resilience & Failure Planning',
                    number: '08',
                    description: 'Plan for failure before it happens. Systems fail—the question is whether you\'ve designed for graceful degradation and quick recovery.',
                    sections: [
                        {
                            title: 'Failure Modes',
                            description: 'Identify what can go wrong and assess the impact.',
                            questions: [
                                { q: 'What are the single points of failure?', tip: 'Any component where failure causes system-wide outage. Databases, load balancers, DNS. Design for redundancy in critical paths.' },
                                { q: 'What happens when each component fails?', tip: 'Map each failure scenario. Does the system degrade gracefully or crash completely? Document expected behavior for each failure type.' },
                                { q: 'What are the cascading failure risks?', tip: 'One failure triggering others. Database slowdown → request backup → memory exhaustion → crash. Use circuit breakers to prevent cascades.' },
                                { q: 'Can we degrade gracefully? How? Which features?', tip: 'Identify non-critical features that can be disabled. Show cached data if real-time unavailable. Disable recommendations before checkout.' },
                                { q: 'What\'s the blast radius of each failure?', tip: 'How many users affected? What percentage of functionality lost? Contain failures through isolation (bulkheads, separate deployments).' },
                                { q: 'Which failures are acceptable? Which are catastrophic?', tip: 'Some failures are tolerable (slow images) while others aren\'t (data loss, security breach). Prioritize prevention for catastrophic failures.' },
                                { q: 'Dependency failure impact: What if each dependency is down?', tip: 'List every external dependency. What happens if payment provider is down? Email service? Analytics? Have fallbacks for critical dependencies.' },
                                { q: 'Data corruption scenarios: Detection? Recovery?', tip: 'How would you detect corrupted data? Checksums, validation rules, anomaly detection. Recovery requires good backups and audit logs.' }
                            ]
                        },
                        {
                            title: 'Resilience Patterns',
                            description: 'Implement patterns to handle failures gracefully.',
                            questions: [
                                { q: 'Circuit breakers: Where? What thresholds? Fallback behavior?', tip: 'Circuit breakers prevent repeated calls to failing services. Typical threshold: 50% failure rate over 10 requests. Fallback to cache or default.' },
                                { q: 'Retry logic: Where? What backoff strategy? Max attempts?', tip: 'Retry transient failures only. Exponential backoff with jitter prevents thundering herd. 3 retries typical. Don\'t retry non-idempotent operations blindly.' },
                                { q: 'Timeouts: What values? Connection vs read timeouts?', tip: 'Every external call needs a timeout. Connection timeout: 1-5s. Read timeout: depends on operation. Without timeouts, threads hang forever.' },
                                { q: 'Bulkheads: Resource isolation between components?', tip: 'Separate thread pools, connection pools, and resources. One slow feature shouldn\'t consume all resources. Like ship compartments that limit flooding.' },
                                { q: 'Rate limiting: Where? What limits? Per user? Per IP?', tip: 'Protect against abuse and traffic spikes. Rate limit at API gateway and within services. Per-user is fairest; per-IP can be gamed.' },
                                { q: 'Load shedding: Priority of requests when overloaded?', tip: 'When overwhelmed, reject low-priority requests to serve high-priority ones. Health checks > paid features > free features.' },
                                { q: 'Fallback strategies: Cached responses? Default values? Degraded mode?', tip: 'When primary fails, have a plan B. Return cached data, static defaults, or simplified functionality. Users prefer partial service over error pages.' },
                                { q: 'Health checks: Liveness? Readiness? Dependencies included?', tip: 'Liveness: is the process running? Readiness: can it handle traffic? Include critical dependencies in readiness. Don\'t fail liveness for transient issues.' }
                            ]
                        },
                        {
                            title: 'Recovery & Redundancy',
                            description: 'Design mechanisms to recover quickly and prevent data loss.',
                            questions: [
                                { q: 'Backup strategy: What? How often? Where stored? Tested when?', tip: 'Back up all critical data. Frequency based on RPO. Store backups in different region/account. Test restores quarterly—untested backups fail.' },
                                { q: 'Point-in-time recovery capability?', tip: 'PITR allows recovery to any moment (e.g., before a bad deploy). Essential for databases. Typically uses continuous WAL/binlog archiving.' },
                                { q: 'Disaster recovery plan: Documented? Tested? RTO/RPO met?', tip: 'Written DR plan with clear steps. Test it—plans that aren\'t tested don\'t work under pressure. Verify RTO/RPO requirements are actually achievable.' },
                                { q: 'Redundancy: Active-active? Active-passive? Multi-region?', tip: 'Active-active: both serve traffic (complex but no failover delay). Active-passive: standby takes over on failure. Multi-region for geographic resilience.' },
                                { q: 'Failover process: Automatic? Manual? DNS-based?', tip: 'Automatic failover is faster but risky if misconfigured. Manual gives control but delays recovery. DNS failover is simple but slow (TTL propagation).' },
                                { q: 'Data replication: Sync? Async? Lag tolerance?', tip: 'Sync replication: zero data loss but higher latency. Async: potential data loss but better performance. Know your RPO tolerance.' },
                                { q: 'Incident response process: Runbooks? On-call rotation?', tip: 'Documented runbooks for common incidents. Clear on-call rotation with escalation paths. Practice incidents—don\'t discover gaps during real outages.' },
                                { q: 'Post-incident review process: Blameless? Action items tracked?', tip: 'Blameless post-mortems focus on systems, not people. Track action items to completion. Share learnings across the organization.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'security',
                    phase: 'Security & Privacy',
                    number: '09',
                    description: 'Build security in from the start, not as an afterthought. Consider authentication, authorization, data protection, and compliance requirements.',
                    sections: [
                        {
                            title: 'Authentication & Authorization',
                            description: 'Define how users and services prove identity and access resources.',
                            questions: [
                                { q: 'Authentication method: OAuth2? SAML? OIDC? API keys?', tip: 'OAuth2/OIDC for modern web apps. SAML for enterprise SSO. API keys for simple service auth. Don\'t build your own crypto or auth protocols.' },
                                { q: 'Identity provider: Build vs buy? (Auth0, Okta, Cognito, Keycloak)', tip: 'Buy for most cases—auth is hard to get right. Auth0/Okta for SaaS. Cognito for AWS. Keycloak if you need self-hosted. Building is risky and expensive.' },
                                { q: 'Multi-factor authentication: Required? Which factors?', tip: 'MFA for sensitive operations. TOTP apps (Google Authenticator) are standard. SMS is weak but better than nothing. Hardware keys for high security.' },
                                { q: 'Session management: Tokens? Cookies? Expiration policy?', tip: 'JWTs for stateless APIs. Cookies for web apps (with HttpOnly, Secure, SameSite). Short expiration with refresh tokens. Implement logout properly.' },
                                { q: 'Authorization model: RBAC? ABAC? Policy-based?', tip: 'RBAC (Role-Based) is simplest—users have roles, roles have permissions. ABAC (Attribute-Based) for complex rules. Start simple, add complexity as needed.' },
                                { q: 'Permission granularity: Resource-level? Field-level?', tip: 'Resource-level (can access document) is usually enough. Field-level (can see salary field) adds complexity. Match granularity to actual requirements.' },
                                { q: 'Service-to-service auth: mTLS? Service accounts? JWT?', tip: 'mTLS for zero-trust networking. Service accounts with short-lived tokens. JWTs for passing identity across services. Avoid shared secrets between services.' },
                                { q: 'API authentication: API keys? OAuth tokens? Both?', tip: 'API keys for simple identification. OAuth tokens for user context. API keys are easily leaked—rotate regularly. Use scopes to limit token permissions.' }
                            ]
                        },
                        {
                            title: 'Data Protection',
                            description: 'Protect data at rest, in transit, and in use.',
                            questions: [
                                { q: 'Encryption at rest: What data? What algorithm? Key management?', tip: 'Encrypt all sensitive data at rest. AES-256 is standard. Use managed key services (AWS KMS, Cloud KMS). Never store keys with the encrypted data.' },
                                { q: 'Encryption in transit: TLS version? Certificate management?', tip: 'TLS 1.2+ everywhere. Automate certificate renewal (Let\'s Encrypt, ACM). Internal services should use TLS too. Certificate pinning for mobile apps.' },
                                { q: 'Secret management: Where stored? (Vault, AWS Secrets Manager, etc.)', tip: 'Never commit secrets to code. Use dedicated secret management. HashiCorp Vault for on-prem. Cloud provider secret managers for cloud-native.' },
                                { q: 'Key rotation policy: Frequency? Automation?', tip: 'Rotate keys regularly (annually minimum). Automate rotation—manual processes get skipped. Ensure old data can still be decrypted during transition.' },
                                { q: 'PII handling: Identification? Encryption? Tokenization? Masking?', tip: 'Know where PII lives in your system. Encrypt at rest, mask in logs. Tokenization replaces sensitive data with non-sensitive tokens. Minimize PII collection.' },
                                { q: 'Data classification: Levels? Handling requirements per level?', tip: 'Classify data: public, internal, confidential, restricted. Each level has different handling requirements. Makes security decisions easier.' },
                                { q: 'Database encryption: Column-level? Table-level? Disk-level?', tip: 'Disk-level is easiest (transparent). Column-level for specific sensitive fields. Consider performance impact. Encryption doesn\'t help if the app is compromised.' },
                                { q: 'Backup encryption: Same keys? Different keys?', tip: 'Always encrypt backups. Use different keys than primary data if possible. Ensure you can still restore—test decryption of backups regularly.' }
                            ]
                        },
                        {
                            title: 'Security Practices',
                            description: 'Establish security processes and controls.',
                            questions: [
                                { q: 'Security scanning: SAST tools? DAST tools? Container scanning?', tip: 'SAST (static) scans code for vulnerabilities. DAST (dynamic) tests running applications. Container scanning checks images. Run all in CI pipeline.' },
                                { q: 'Dependency vulnerability scanning: Frequency? Remediation SLA?', tip: 'Scan dependencies daily. Dependabot, Snyk, or similar. Define SLAs: critical vulnerabilities fixed within 24 hours, high within a week.' },
                                { q: 'Penetration testing: Frequency? Scope? Internal or third-party?', tip: 'Professional pen testing annually minimum. Third-party for unbiased view. Define scope clearly. Act on findings promptly.' },
                                { q: 'Security review process: When required? Who reviews?', tip: 'Security review for new features touching auth, payments, PII. Trained security champions or dedicated team. Integrate into PR process.' },
                                { q: 'OWASP Top 10: How addressed? (Injection, XSS, CSRF, etc.)', tip: 'Know the OWASP Top 10 vulnerabilities. Use frameworks that prevent them by default. Input validation, output encoding, parameterized queries.' },
                                { q: 'DDoS protection: CDN? WAF? Rate limiting?', tip: 'CDN absorbs traffic at the edge. WAF filters malicious requests. Rate limiting protects against abuse. Layer these defenses.' },
                                { q: 'Audit logging: What\'s logged? Retention? Access controls?', tip: 'Log security-relevant events: auth, access, changes. Immutable storage. Long retention for compliance. Restrict access to audit logs.' },
                                { q: 'Incident response plan: Security-specific procedures?', tip: 'Document steps for security incidents. Include containment, investigation, communication. Know when to involve legal and PR. Practice with tabletop exercises.' }
                            ]
                        },
                        {
                            title: 'Privacy & Compliance',
                            description: 'Ensure you handle user data responsibly and legally.',
                            questions: [
                                { q: 'What PII do we collect? Why? Minimization applied?', tip: 'Inventory all personal data collected. Question if each piece is necessary. Data you don\'t collect can\'t be breached. Minimize collection.' },
                                { q: 'Data retention policy: How long? Automated deletion?', tip: 'Define retention periods for each data type. Automate deletion—manual processes are forgotten. Shorter retention reduces risk and storage costs.' },
                                { q: 'Right to deletion (RTBF): How implemented? Timeline?', tip: 'Users can request data deletion (GDPR, CCPA). Implement deletion across all systems including backups. 30-day response typical.' },
                                { q: 'Data portability: Export format? Delivery method?', tip: 'Users can request their data in portable format. Common formats: JSON, CSV. Secure delivery method. Automate if possible.' },
                                { q: 'Consent management: How captured? How honored?', tip: 'Clear consent for data collection. Record when consent was given. Honor withdrawal of consent. Cookie banners, privacy preferences.' },
                                { q: 'Privacy by design: Data flow mapping? Impact assessments?', tip: 'Map where personal data flows in your system. Privacy impact assessments for new features. Consider privacy from the start, not after.' },
                                { q: 'Compliance requirements: GDPR? CCPA? HIPAA? SOC2? PCI-DSS?', tip: 'Know which regulations apply to you. GDPR for EU users. CCPA for California. HIPAA for health data. SOC2 for B2B trust. PCI-DSS for payments.' },
                                { q: 'Third-party data sharing: DPAs in place? Purpose limitations?', tip: 'Data Processing Agreements with all vendors handling user data. Define purpose and limitations. Know where your data goes.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'observability',
                    phase: 'Observability & Operations',
                    number: '10',
                    description: 'You can\'t fix what you can\'t see. Plan how you\'ll monitor, debug, and operate the system in production from day one.',
                    sections: [
                        {
                            title: 'Monitoring & Metrics',
                            description: 'Define what to measure and how to know when things go wrong.',
                            questions: [
                                { q: 'Key metrics: What are the Golden Signals? (Latency, traffic, errors, saturation)', tip: 'Google\'s Golden Signals: latency (response time), traffic (requests/sec), errors (failure rate), saturation (resource usage). Start here for any service.' },
                                { q: 'Business metrics: What do stakeholders need to see?', tip: 'Revenue, conversions, active users, feature adoption. Connect technical metrics to business outcomes. Dashboard for non-technical stakeholders.' },
                                { q: 'Infrastructure metrics: CPU, memory, disk, network?', tip: 'Basic resource metrics for capacity planning. Track trends over time. Set alerts before exhaustion (80% disk, 90% memory).' },
                                { q: 'Application metrics: Request rates, response times, queue depths?', tip: 'Application-level metrics show business health. Queue depths indicate backpressure. Response time percentiles (P50, P95, P99) matter more than averages.' },
                                { q: 'Custom metrics: What domain-specific metrics?', tip: 'Metrics specific to your business: orders processed, messages sent, ML model accuracy. These often matter most for understanding system health.' },
                                { q: 'Metrics platform: Prometheus? Datadog? CloudWatch? New Relic?', tip: 'Prometheus for self-hosted (free, powerful). Datadog/New Relic for full-featured SaaS. CloudWatch for AWS-native. Consider cost at scale.' },
                                { q: 'Dashboards: What views? Who\'s the audience?', tip: 'Different dashboards for different audiences. Executive: business metrics. Engineers: technical deep-dives. On-call: actionable alerts. Keep dashboards focused.' },
                                { q: 'SLIs/SLOs/SLAs defined? Error budgets calculated?', tip: 'SLI: what you measure. SLO: target (99.9% availability). SLA: contractual commitment. Error budget = allowed failures. Enables risk-based decision making.' }
                            ]
                        },
                        {
                            title: 'Alerting',
                            description: 'Define when and how to notify the team of issues.',
                            questions: [
                                { q: 'Alerting thresholds: What triggers alerts? Avoid alert fatigue?', tip: 'Alert on symptoms (user impact), not causes (high CPU). Avoid noisy alerts—each should be actionable. If you ignore alerts, they\'re too sensitive.' },
                                { q: 'Severity levels: P1/P2/P3? Response time expectations?', tip: 'P1: service down, immediate response. P2: degraded, respond within hours. P3: minor, next business day. Clear definitions prevent confusion.' },
                                { q: 'Notification channels: PagerDuty? Slack? Email? Phone?', tip: 'PagerDuty/Opsgenie for on-call management. Slack for team awareness. Phone for critical alerts. Escalate through channels based on severity.' },
                                { q: 'Escalation policy: Who\'s paged? When to escalate?', tip: 'Clear escalation path: primary on-call → secondary → manager → leadership. Auto-escalate if not acknowledged. Document who can make what decisions.' },
                                { q: 'On-call rotation: Schedule? Compensation? Handoff process?', tip: 'Fair rotation schedule. Compensate for on-call burden. Handoff process: share context, ongoing issues, recent changes. On-call shouldn\'t burn people out.' },
                                { q: 'Alert runbooks: Documented response procedures?', tip: 'Every alert should link to a runbook. What to check, how to mitigate, when to escalate. Reduces MTTR and knowledge dependency.' },
                                { q: 'Alert aggregation: Grouping related alerts?', tip: 'Group related alerts to reduce noise. One incident, one notification. Correlation helps identify root cause faster.' },
                                { q: 'Maintenance windows: Silencing alerts during deployments?', tip: 'Silence known-noisy alerts during maintenance. But keep critical alerts active. Auto-end maintenance windows to prevent forgotten silences.' }
                            ]
                        },
                        {
                            title: 'Logging & Tracing',
                            description: 'Enable debugging and understanding of system behavior.',
                            questions: [
                                { q: 'Logging format: Structured (JSON)? Log levels?', tip: 'Structured logging (JSON) enables querying and analysis. Standard log levels: DEBUG, INFO, WARN, ERROR. Include request IDs, user IDs, timestamps.' },
                                { q: 'Log aggregation: ELK? Splunk? CloudWatch Logs? Loki?', tip: 'ELK (Elasticsearch, Logstash, Kibana) is powerful but complex. Splunk is expensive but feature-rich. CloudWatch for AWS. Loki for Prometheus ecosystem.' },
                                { q: 'Log retention: How long? Tiered storage?', tip: 'Hot storage for recent logs (7-30 days). Cold storage for compliance/debugging (1-7 years). Archive to cheaper storage. Define retention by log type.' },
                                { q: 'Distributed tracing: OpenTelemetry? Jaeger? Zipkin? X-Ray?', tip: 'Tracing shows request flow across services. OpenTelemetry is the emerging standard. Essential for debugging microservices. Instrument all services.' },
                                { q: 'Trace sampling strategy: Head-based? Tail-based? Rate?', tip: 'Tracing everything is expensive. Head-based sampling decides upfront. Tail-based keeps interesting traces. Sample 1-10% typically, always keep errors.' },
                                { q: 'Correlation IDs: How propagated across services?', tip: 'Unique ID per request, passed through all services. Include in logs, traces, and error reports. Makes debugging distributed systems possible.' },
                                { q: 'What to log: Requests? Errors? Debug info? PII concerns?', tip: 'Log all requests (summarized), all errors (detailed), key business events. Never log passwords, tokens, or raw PII. Mask sensitive data.' },
                                { q: 'Log-based alerting: Error rate spikes? Specific patterns?', tip: 'Alert on unusual error patterns, not individual errors. Spike in 500s, unusual exception types, security-relevant events. Complements metric alerting.' }
                            ]
                        },
                        {
                            title: 'Debugging & Profiling',
                            description: 'Tools and processes for investigating issues.',
                            questions: [
                                { q: 'APM tool: Datadog? New Relic? Dynatrace?', tip: 'Application Performance Monitoring combines metrics, traces, and logs. Expensive but powerful for complex systems. Essential for production debugging.' },
                                { q: 'Profiling: CPU? Memory? When enabled?', tip: 'CPU profiling finds slow code. Memory profiling finds leaks. Enable on-demand or continuously with low overhead. Flame graphs visualize results.' },
                                { q: 'Error tracking: Sentry? Rollbar? Bugsnag?', tip: 'Error tracking groups similar errors, shows trends, alerts on new issues. Sentry is popular open-source option. Integrates with issue trackers.' },
                                { q: 'How to debug production issues safely?', tip: 'Read-only access to production. Replay requests in staging. Feature flags to disable problematic code. Never debug by changing production code.' },
                                { q: 'Feature flags for debug modes?', tip: 'Enable verbose logging or debug endpoints per-user or per-request. Useful for investigating specific issues without affecting all users.' },
                                { q: 'Access to production logs: Who? How? Audit trail?', tip: 'Limit production access to those who need it. JIT (Just-In-Time) access with approval. Audit all access. Principle of least privilege.' },
                                { q: 'Reproduction environments: Can we replicate prod issues?', tip: 'Staging environment with production-like data. Ability to replay requests. Some issues only appear at scale—consider load testing environments.' },
                                { q: 'Post-mortem process: Template? Frequency? Tracking?', tip: 'Post-mortem after every significant incident. Blameless culture. Track action items to completion. Share learnings. Build institutional memory.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'cost',
                    phase: 'Cost & Resource Planning',
                    number: '11',
                    description: 'Understand and optimize the cost of running your system. Cloud costs can grow quickly without proper planning and monitoring.',
                    sections: [
                        {
                            title: 'Cost Estimation',
                            description: 'Estimate infrastructure and operational costs.',
                            questions: [
                                { q: 'Compute costs: Instance types? Sizing? Reserved vs on-demand?', tip: 'Start with on-demand for flexibility, move to reserved for stable workloads (30-60% savings). Right-size based on actual usage, not guesses.' },
                                { q: 'Storage costs: Data volume? Storage tiers? Growth rate?', tip: 'Estimate data growth over 1-3 years. Use tiered storage: hot (frequent access), warm (occasional), cold (archive). Lifecycle policies automate transitions.' },
                                { q: 'Network costs: Data transfer? Cross-region? CDN?', tip: 'Data transfer costs surprise many teams. Cross-region transfer is expensive. CDN reduces origin traffic and improves latency. Track egress carefully.' },
                                { q: 'Database costs: Instance size? Storage? IOPS? Replicas?', tip: 'Databases are often the largest cost. IOPS can be expensive. Read replicas add cost but improve performance. Consider serverless for variable workloads.' },
                                { q: 'Third-party service costs: APIs? SaaS tools? Licenses?', tip: 'Sum up all third-party costs: APIs (per-call pricing), SaaS tools (per-seat), licenses. These can exceed infrastructure costs. Negotiate enterprise agreements.' },
                                { q: 'Total monthly cost estimate? Annual projection?', tip: 'Build a cost model in a spreadsheet. Include all components. Add 20-30% buffer for unknowns. Project growth scenarios.' },
                                { q: 'Cost per user/request/transaction?', tip: 'Unit economics matter for business viability. Know your cost per user, per transaction, per 1000 requests. Benchmark against industry standards.' },
                                { q: 'Budget limits and alerts?', tip: 'Set budget alerts at 50%, 75%, 90%, 100%. Anomaly detection for unexpected spikes. Review weekly/monthly. No surprises.' }
                            ]
                        },
                        {
                            title: 'Cost Optimization',
                            description: 'Strategies to reduce and control costs.',
                            questions: [
                                { q: 'Reserved instances/savings plans: Commitment level?', tip: '1-year commits: 30-40% savings. 3-year: 50-60% but risky. Start with 1-year for predictable workloads. Savings plans are more flexible than reserved instances.' },
                                { q: 'Spot/preemptible instances: Where applicable?', tip: 'Spot instances: 60-90% savings but can be terminated. Good for: batch jobs, CI/CD, stateless workers. Not for: databases, user-facing services.' },
                                { q: 'Auto-scaling policies: Scale-down aggressive enough?', tip: 'Most teams scale up well but scale down too slowly. Set aggressive scale-down policies. Target utilization 60-70%, not 30%.' },
                                { q: 'Right-sizing: Regular review of resource utilization?', tip: 'Review utilization monthly. Most instances are over-provisioned. Use cloud provider tools (AWS Compute Optimizer, GCP Recommender). Right-size before reserving.' },
                                { q: 'Storage lifecycle policies: Auto-archive? Auto-delete?', tip: 'Automate storage tiering: move to infrequent access after 30 days, glacier after 90, delete after retention period. Forgotten data costs money.' },
                                { q: 'Caching ROI: Cost savings from caching layer?', tip: 'Caching reduces database load and API calls. Calculate: cache cost vs. savings from reduced compute/database. Good caches pay for themselves 10x.' },
                                { q: 'Multi-tenancy efficiency: Resource sharing between tenants?', tip: 'Shared resources are more efficient than per-tenant isolation. Balance efficiency against isolation requirements. Noisy neighbor mitigation is key.' },
                                { q: 'Development/staging cost controls: Shutdown schedules?', tip: 'Dev/staging environments often run 24/7 but are used 8-10 hours/day. Auto-shutdown schedules can cut non-prod costs 60%. Use smaller instances for non-prod.' }
                            ]
                        },
                        {
                            title: 'Cost Monitoring',
                            description: 'Track and manage costs over time.',
                            questions: [
                                { q: 'Cost allocation tags: By team? By feature? By environment?', tip: 'Tag everything: team, project, environment, cost center. Enables showback/chargeback. Enforce tagging through policies. Untagged resources get attention.' },
                                { q: 'Cost anomaly detection: Alerts for unexpected spikes?', tip: 'Cloud providers offer anomaly detection. Alert on unusual spending patterns. Catch runaway costs before month-end surprise. Daily cost emails help awareness.' },
                                { q: 'Showback/chargeback model: How costs attributed to teams?', tip: 'Showback: inform teams of costs. Chargeback: teams pay from their budget. Start with showback to build awareness. Chargeback drives ownership.' },
                                { q: 'Regular cost review: Frequency? Who\'s involved?', tip: 'Monthly cost reviews minimum. Include engineering leads, finance, product. Review top spending categories, anomalies, and optimization opportunities.' },
                                { q: 'FinOps practices: Dedicated role? Tools?', tip: 'FinOps combines finance, ops, and engineering for cloud cost management. Dedicated FinOps engineer at scale. Tools: CloudHealth, Spot.io, native cloud tools.' },
                                { q: 'Cost forecasting: Based on growth projections?', tip: 'Forecast costs based on user growth, data growth, feature releases. Update forecasts quarterly. Finance needs predictability for budgeting.' },
                                { q: 'Optimization opportunities tracking?', tip: 'Track identified savings opportunities, implementation status, and realized savings. Prioritize by effort vs. impact. Celebrate wins to build momentum.' },
                                { q: 'Vendor contract reviews: Annual? Negotiation strategy?', tip: 'Review contracts annually before renewal. Negotiate based on usage data and market alternatives. Committed spend deals can save 20-30%. Get quotes from competitors.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'team',
                    phase: 'Team & Organization',
                    number: '12',
                    description: 'Architecture must match team capabilities and structure. The best technical design fails if the team can\'t build or maintain it.',
                    sections: [
                        {
                            title: 'Team Capabilities',
                            description: 'Assess whether your team can build and maintain this system.',
                            questions: [
                                { q: 'Team size: Current? 6 months? 1 year?', tip: 'Architecture should match team size. Microservices with 3 people is usually a mistake. Plan for realistic team growth, not optimistic projections.' },
                                { q: 'Team expertise: Strengths? Gaps? Training needed?', tip: 'Honest assessment of skills. Don\'t adopt Kubernetes if no one knows it. Training takes time. Gaps require hiring or consultants.' },
                                { q: 'Learning curve: Can the team realistically support this?', tip: 'New technology = learning curve = slower delivery initially. Factor in ramp-up time. Complex architecture needs experienced engineers.' },
                                { q: 'Cognitive load: Is this architecture too complex?', tip: 'If engineers can\'t hold the system in their head, it\'s too complex. Simplify. Team Topologies: minimize cognitive load per team.' },
                                { q: 'Hiring plan: What roles needed? Timeline?', tip: 'Hiring is slow (3-6 months). Plan ahead. Define roles clearly. Senior engineers are hard to find. Consider contractors for specific skills.' },
                                { q: 'Contractor/consultant needs: What expertise to bring in?', tip: 'Consultants for: initial architecture, specific technology, knowledge transfer. Set clear goals and timelines. Don\'t create permanent dependencies.' },
                                { q: 'Knowledge concentration risk: Bus factor?', tip: 'Bus factor: how many people can leave before system becomes unmaintainable? Aim for 2+ people knowing each critical area. Document tribal knowledge.' },
                                { q: 'Cross-training plan: Reducing single points of knowledge?', tip: 'Pair programming, rotation, documentation, code reviews. No single-owner code. Everyone should be able to deploy. Reduce hero culture.' }
                            ]
                        },
                        {
                            title: 'Team Structure',
                            description: 'Align architecture with organizational structure.',
                            questions: [
                                { q: 'Conway\'s Law: Does architecture match team structure?', tip: 'Systems mirror communication structures. If you want independent services, you need independent teams. Reorganize teams to match desired architecture.' },
                                { q: 'Team autonomy: Can teams deploy independently?', tip: 'Autonomous teams are faster. Minimize dependencies. Clear interfaces between teams. If every change needs coordination, you\'re coupled.' },
                                { q: 'Service ownership: Clear owners for each component?', tip: 'Every service needs an owner. Ownership means: on-call, roadmap, tech debt decisions. Unowned services rot. Explicit ownership in docs and code.' },
                                { q: 'On-call responsibility: Who owns production issues?', tip: 'You build it, you run it. Teams own their services end-to-end. Clear escalation paths. Fair rotation. Don\'t burn out your on-call engineers.' },
                                { q: 'Communication patterns: Sync? Async? Meeting cadence?', tip: 'Too many meetings kill productivity. Async-first (docs, Slack) with targeted sync meetings. Cross-team syncs for dependencies. Document decisions.' },
                                { q: 'Decision-making process: RFCs? ADRs? Architecture review?', tip: 'RFCs for proposals, ADRs for decisions. Architecture review for significant changes. Balance process with speed. Not everything needs a meeting.' },
                                { q: 'Cross-team dependencies: How managed?', tip: 'Dependencies slow teams down. Minimize them through clear interfaces. Track dependencies explicitly. Prioritize unblocking other teams.' },
                                { q: 'Platform team: Dedicated infrastructure/platform support?', tip: 'Platform teams provide self-service infrastructure: CI/CD, observability, databases. Enables product teams to focus on product. Needs investment at scale.' }
                            ]
                        },
                        {
                            title: 'Operational Burden',
                            description: 'Consider the ongoing cost of running and evolving the system.',
                            questions: [
                                { q: 'Deployment frequency: Current? Target?', tip: 'Deploy frequency is a health metric. Daily or more is healthy. Weekly is okay. Monthly is a smell. Blocked deployments indicate problems.' },
                                { q: 'Deployment complexity: Steps? Automation level?', tip: 'Deployments should be boring—one click or automatic. Complex deployment procedures are risky. Automate everything. Document what remains manual.' },
                                { q: 'Incident frequency: Current? Target?', tip: 'Track incident rate. High frequency = systemic issues. Categorize by type and severity. Set targets and track trends. Each incident is a learning opportunity.' },
                                { q: 'MTTR (Mean Time to Recovery): Current? Target?', tip: 'MTTR matters more than MTBF. Can you recover quickly? Target < 1 hour for major incidents. Runbooks, automation, and practice improve MTTR.' },
                                { q: 'Technical debt management: How tracked? When addressed?', tip: 'Track tech debt in backlog. Allocate 10-20% of capacity for debt reduction. Address debt that slows development. Don\'t let it accumulate indefinitely.' },
                                { q: 'Toil reduction: Automation opportunities?', tip: 'Toil: repetitive, manual, automatable work. Track toil. Automate it. Engineers should spend time on engineering, not repetitive operations.' },
                                { q: 'Documentation maintenance: Who? How kept current?', tip: 'Outdated docs are worse than no docs. Doc owners for each area. Update docs as part of PR process. Regular doc review and cleanup.' },
                                { q: 'Onboarding time: How long for new team members?', tip: 'Track time-to-productivity for new hires. Target: meaningful contribution in 2-4 weeks. Long onboarding indicates complexity or documentation gaps.' }
                            ]
                        }
                    ]
                },
                {
                    id: 'evolution',
                    phase: 'Evolution & Future-Proofing',
                    number: '13',
                    description: 'Systems evolve. Design for change by identifying what\'s likely to change, what\'s hard to change, and how you\'ll migrate without disruption.',
                    sections: [
                        {
                            title: 'Change Management',
                            description: 'Plan how to evolve the system safely over time.',
                            questions: [
                                { q: 'What will we learn post-launch that might change things?', tip: 'You will learn a lot after launch: real usage patterns, actual scale, unexpected use cases. Design for learning. Build in flexibility where uncertain.' },
                                { q: 'Which parts are hardest to change later?', tip: 'Database schema, API contracts, data formats, core domain model. Get these right or plan for migration. Changing foundations is expensive.' },
                                { q: 'Which parts should stay flexible?', tip: 'UI, business rules, integrations—these change frequently. Design for configurability. Feature flags enable runtime changes without deploys.' },
                                { q: 'Migration strategy: How do we evolve without downtime?', tip: 'Zero-downtime migrations: expand-contract pattern, parallel running, gradual rollout. Plan migrations before you need them. Test migration scripts.' },
                                { q: 'Versioning strategy: APIs? Data schemas? Configurations?', tip: 'Version everything that has consumers: APIs, events, configs. Semantic versioning for clarity. Support N-1 at minimum. Plan for deprecation.' },
                                { q: 'Deprecation strategy: How do we sunset old versions?', tip: 'Clear deprecation policy: announce → warn → soft-fail → remove. Give consumers time. Monitor usage of deprecated features. Don\'t support forever.' },
                                { q: 'Feature flags: Gradual rollout? A/B testing infrastructure?', tip: 'Feature flags decouple deploy from release. Gradual rollout reduces risk. A/B testing enables experimentation. Clean up old flags regularly.' },
                                { q: 'Database schema evolution: Online migrations? Expand/contract?', tip: 'Online migrations don\'t lock tables. Expand-contract: add new column, backfill, migrate reads, migrate writes, remove old. Avoid breaking changes.' }
                            ]
                        },
                        {
                            title: 'Scalability Planning',
                            description: 'Anticipate and plan for growth.',
                            questions: [
                                { q: 'What\'s our scale plan? 10x? 100x?', tip: 'Design for 10x current scale. Have a plan for 100x. Don\'t over-engineer for 1000x if you\'re at 1x. Scale when you have real data.' },
                                { q: 'Which components will hit limits first?', tip: 'Identify bottlenecks before they bite. Usually: database, then compute, then network. Load test to find limits. Plan remediation before hitting them.' },
                                { q: 'Horizontal vs vertical scaling: Where each applies?', tip: 'Vertical (bigger machines) is simpler but has limits. Horizontal (more machines) is unlimited but complex. Stateless services scale horizontally. Databases are harder.' },
                                { q: 'Database scaling path: Read replicas? Sharding? NewSQL?', tip: 'Read replicas for read-heavy workloads. Sharding for write-heavy (complex!). NewSQL (CockroachDB, Spanner) for distributed SQL. Each has trade-offs.' },
                                { q: 'Caching scaling: Cluster? Sharding?', tip: 'Redis Cluster or Memcached pool for scale. Consider cache sharding strategy. Hot keys can be a problem. Plan for cache invalidation at scale.' },
                                { q: 'What architectural changes needed at each scale milestone?', tip: 'Document: at 10x we need X, at 100x we need Y. Plan major changes before you\'re in crisis mode. Some changes are easier earlier.' },
                                { q: 'Multi-region expansion plan?', tip: 'Multi-region for: latency, compliance, disaster recovery. Adds significant complexity: data replication, consistency, routing. Don\'t do it prematurely.' },
                                { q: 'What would break if we 10x users tomorrow?', tip: 'Thought experiment: viral growth tomorrow. What breaks? Rate limits, database connections, third-party API limits. Know your weak points.' }
                            ]
                        },
                        {
                            title: 'Future Considerations',
                            description: 'Think ahead to future needs and opportunities.',
                            questions: [
                                { q: 'What new features are on the roadmap?', tip: 'Architecture should enable the roadmap, not block it. Review upcoming features with architecture lens. Identify patterns and shared needs.' },
                                { q: 'How does this architecture enable/constrain future products?', tip: 'Platforms enable new products. Monolithic designs constrain them. Think beyond current product. What else could you build on this foundation?' },
                                { q: 'Technology refresh: When will current choices become obsolete?', tip: 'Technologies have lifecycles. Plan for eventual replacement. Avoid deep coupling to specific implementations. Abstract where practical.' },
                                { q: 'Vendor lock-in assessment: What\'s the exit cost?', tip: 'Some lock-in is okay if benefits are worth it. Know the exit cost. Use abstractions for critical integrations. Portable where strategic, pragmatic elsewhere.' },
                                { q: 'Open source vs proprietary: Long-term implications?', tip: 'Open source: transparency, portability, community. Proprietary: support, features, integration. Consider long-term viability and community health.' },
                                { q: 'AI/ML integration: Future data and compute needs?', tip: 'AI/ML needs: data collection, storage, compute (often GPU), model serving. Plan data pipelines even if ML is future. Clean data is valuable.' },
                                { q: 'Regulatory changes: Anticipated compliance requirements?', tip: 'Regulations are increasing: privacy, data residency, AI governance. Build compliance capabilities early. It\'s easier than retrofitting.' },
                                { q: 'Acquisition/integration: How hard to integrate/be integrated?', tip: 'M&A happens. How hard to integrate another system? How hard for acquirer to integrate you? Clean architecture and APIs help both scenarios.' }
                            ]
                        }
                    ]
                }
            ];

            // Calculate all section keys for expand/collapse all
            const allSectionKeys = useMemo(() => {
                const keys = [];
                framework.forEach(phase => {
                    phase.sections.forEach((_, sIndex) => {
                        keys.push(`${phase.id}-${sIndex}`);
                    });
                });
                return keys;
            }, []);

            const toggleSection = (phaseId, sectionIndex) => {
                const key = `${phaseId}-${sectionIndex}`;
                setExpandedSections(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const expandAll = () => {
                const expanded = {};
                allSectionKeys.forEach(key => expanded[key] = true);
                setExpandedSections(expanded);
            };

            const collapseAll = () => {
                setExpandedSections({});
            };

            const toggleCheck = (phaseId, sectionIndex, questionIndex) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setCheckedItems(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const updateNote = (phaseId, sectionIndex, questionIndex, value) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setNotes(prev => ({
                    ...prev,
                    [key]: value
                }));
            };

            const updateCodeSnippet = (phaseId, sectionIndex, questionIndex, value) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setCodeSnippets(prev => ({
                    ...prev,
                    [key]: value
                }));
            };

            const updateDiagram = (phaseId, sectionIndex, questionIndex, value) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setDiagrams(prev => ({
                    ...prev,
                    [key]: value
                }));
            };

            const setActiveTab = (phaseId, sectionIndex, questionIndex, tab) => {
                const key = `${phaseId}-${sectionIndex}-${questionIndex}`;
                setActiveTabs(prev => ({
                    ...prev,
                    [key]: tab
                }));
            };

            const addReference = () => {
                if (newReference.url.trim()) {
                    setReferences(prev => [...prev, {
                        ...newReference,
                        id: Date.now(),
                        title: newReference.title.trim() || newReference.url
                    }]);
                    setNewReference({ title: '', url: '' });
                }
            };

            const removeReference = (id) => {
                setReferences(prev => prev.filter(r => r.id !== id));
            };

            const calculateProgress = () => {
                const totalQuestions = framework.reduce((acc, phase) =>
                    acc + phase.sections.reduce((sAcc, section) => sAcc + section.questions.length, 0), 0
                );
                const checkedCount = Object.values(checkedItems).filter(Boolean).length;
                return Math.round((checkedCount / totalQuestions) * 100);
            };

            const resetProgress = () => {
                if (window.confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                    setCheckedItems({});
                    setNotes({});
                    setCodeSnippets({});
                    setDiagrams({});
                    setActiveTabs({});
                    setProjectName('');
                    setExpandedSections({});
                    setStakeholders([]);
                    setReferences([]);
                    localStorage.removeItem(STORAGE_KEY);
                }
            };

            const addStakeholder = () => {
                if (newStakeholder.name.trim()) {
                    setStakeholders(prev => [...prev, { ...newStakeholder, id: Date.now() }]);
                    setNewStakeholder({ name: '', role: '' });
                }
            };

            const removeStakeholder = (id) => {
                setStakeholders(prev => prev.filter(s => s.id !== id));
            };

            const exportNotes = () => {
                let markdown = `# Architecture Framework: ${projectName || 'Untitled Project'}\n\n`;
                markdown += `**Progress**: ${calculateProgress()}%\n\n`;
                markdown += `**Date**: ${new Date().toLocaleDateString()}\n\n`;

                if (stakeholders.length > 0) {
                    markdown += `## Stakeholders\n\n`;
                    markdown += `| Name | Role |\n|------|------|\n`;
                    stakeholders.forEach(s => {
                        markdown += `| ${s.name} | ${s.role || '-'} |\n`;
                    });
                    markdown += `\n`;
                }

                if (references.length > 0) {
                    markdown += `## References\n\n`;
                    references.forEach(r => {
                        markdown += `- [${r.title}](${r.url})\n`;
                    });
                    markdown += `\n`;
                }

                markdown += `---\n\n`;

                framework.forEach(phase => {
                    markdown += `## ${phase.number}. ${phase.phase}\n\n`;
                    markdown += `> ${phase.description}\n\n`;
                    phase.sections.forEach((section, sIndex) => {
                        markdown += `### ${section.title}\n\n`;
                        if (section.description) {
                            markdown += `*${section.description}*\n\n`;
                        }
                        section.questions.forEach((questionItem, qIndex) => {
                            const key = `${phase.id}-${sIndex}-${qIndex}`;
                            const isChecked = checkedItems[key];
                            const note = notes[key];
                            const code = codeSnippets[key];
                            const diagram = diagrams[key];
                            const questionText = typeof questionItem === 'string' ? questionItem : questionItem.q;
                            markdown += `- [${isChecked ? 'x' : ' '}] ${questionText}\n`;
                            if (note) {
                                markdown += `\n  **Answer**: ${note}\n\n`;
                            }
                            if (code) {
                                markdown += `\n  **Code**:\n  \`\`\`\n${code.split('\n').map(l => '  ' + l).join('\n')}\n  \`\`\`\n\n`;
                            }
                            if (diagram) {
                                markdown += `\n  **Diagram**:\n  \`\`\`mermaid\n${diagram.split('\n').map(l => '  ' + l).join('\n')}\n  \`\`\`\n\n`;
                            }
                        });
                        markdown += `\n`;
                    });
                });

                const blob = new Blob([markdown], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `architecture-framework-${projectName.replace(/\s+/g, '-').toLowerCase() || 'project'}.md`;
                a.click();
                URL.revokeObjectURL(url);
            };

            const importMarkdown = (content) => {
                try {
                    const newCheckedItems = {};
                    const newNotes = {};
                    const newCodeSnippets = {};
                    const newDiagrams = {};
                    const newStakeholders = [];
                    const newReferences = [];
                    let newProjectName = '';

                    // Extract project name from title
                    const titleMatch = content.match(/^# Architecture Framework: (.+)$/m);
                    if (titleMatch) {
                        newProjectName = titleMatch[1].trim();
                    }

                    // Extract stakeholders from table
                    const stakeholderSection = content.match(/## Stakeholders\n\n\| Name \| Role \|\n\|------\|------\|\n([\s\S]*?)(?=\n\n|## |$)/);
                    if (stakeholderSection) {
                        const rows = stakeholderSection[1].trim().split('\n');
                        rows.forEach(row => {
                            const match = row.match(/\| (.+?) \| (.+?) \|/);
                            if (match) {
                                newStakeholders.push({
                                    id: Date.now() + Math.random(),
                                    name: match[1].trim(),
                                    role: match[2].trim() === '-' ? '' : match[2].trim()
                                });
                            }
                        });
                    }

                    // Extract references
                    const referencesSection = content.match(/## References\n\n([\s\S]*?)(?=\n---|\n## |$)/);
                    if (referencesSection) {
                        const refLines = referencesSection[1].trim().split('\n');
                        refLines.forEach(line => {
                            const match = line.match(/- \[(.+?)\]\((.+?)\)/);
                            if (match) {
                                newReferences.push({
                                    id: Date.now() + Math.random(),
                                    title: match[1],
                                    url: match[2]
                                });
                            }
                        });
                    }

                    // Process each phase
                    framework.forEach(phase => {
                        phase.sections.forEach((section, sIndex) => {
                            section.questions.forEach((questionItem, qIndex) => {
                                const key = `${phase.id}-${sIndex}-${qIndex}`;
                                const questionText = typeof questionItem === 'string' ? questionItem : questionItem.q;

                                // Escape special regex characters in question text
                                const escapedQuestion = questionText.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');

                                // Look for the checkbox pattern
                                const checkboxPattern = new RegExp(`- \\[(x| )\\] ${escapedQuestion}`);
                                const checkboxMatch = content.match(checkboxPattern);

                                if (checkboxMatch) {
                                    newCheckedItems[key] = checkboxMatch[1] === 'x';

                                    // Find the position after the checkbox line
                                    const checkboxIndex = content.indexOf(checkboxMatch[0]);
                                    const afterCheckbox = content.slice(checkboxIndex + checkboxMatch[0].length);

                                    // Extract answer/note
                                    const answerMatch = afterCheckbox.match(/^\n\n  \*\*Answer\*\*: ([\s\S]*?)(?=\n\n  \*\*|(?:\n- \[)|(?:\n### )|(?:\n## )|$)/);
                                    if (answerMatch) {
                                        newNotes[key] = answerMatch[1].trim();
                                    }

                                    // Extract code
                                    const codeMatch = afterCheckbox.match(/^\n\n  \*\*Code\*\*:\n  ```\n([\s\S]*?)\n  ```/);
                                    if (codeMatch) {
                                        newCodeSnippets[key] = codeMatch[1].split('\n').map(l => l.replace(/^  /, '')).join('\n');
                                    }

                                    // Extract diagram
                                    const diagramMatch = afterCheckbox.match(/\*\*Diagram\*\*:\n  ```mermaid\n([\s\S]*?)\n  ```/);
                                    if (diagramMatch) {
                                        newDiagrams[key] = diagramMatch[1].split('\n').map(l => l.replace(/^  /, '')).join('\n');
                                    }
                                }
                            });
                        });
                    });

                    // Apply imported data
                    setProjectName(newProjectName);
                    setCheckedItems(newCheckedItems);
                    setNotes(newNotes);
                    setCodeSnippets(newCodeSnippets);
                    setDiagrams(newDiagrams);
                    setStakeholders(newStakeholders);
                    setReferences(newReferences);

                    return true;
                } catch (e) {
                    console.error('Import failed:', e);
                    return false;
                }
            };

            const handleFileImport = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    const content = e.target.result;
                    const success = importMarkdown(content);
                    if (success) {
                        alert('Import successful!');
                    } else {
                        alert('Import failed. Please check the file format.');
                    }
                };
                reader.readAsText(file);
                event.target.value = ''; // Reset input
            };

            const totalQuestions = framework.reduce((acc, phase) =>
                acc + phase.sections.reduce((sAcc, section) => sAcc + section.questions.length, 0), 0
            );

            return (
                <div className={`min-h-screen transition-colors duration-300 ${darkMode ? 'dark bg-zinc-950' : 'bg-zinc-50'}`}>
                    <div className="flex">
                        {/* Sidebar */}
                        <div className={`hidden lg:flex lg:flex-col lg:w-72 lg:fixed lg:inset-y-0 border-r transition-colors duration-300 ${darkMode ? 'bg-zinc-900 border-zinc-800' : 'bg-white border-zinc-200'}`}>
                            <div className="flex-1 flex flex-col overflow-y-auto p-5">
                                {/* Header */}
                                <div className="flex items-center justify-between mb-4">
                                    <h1 className={`text-lg font-semibold tracking-tight ${darkMode ? 'text-zinc-100' : 'text-zinc-900'}`}>
                                        Architecture Framework
                                    </h1>
                                    <button
                                        onClick={() => setDarkMode(!darkMode)}
                                        className={`p-1.5 rounded-lg transition-colors ${darkMode ? 'hover:bg-zinc-800 text-zinc-400' : 'hover:bg-zinc-100 text-zinc-600'}`}
                                        aria-label="Toggle dark mode"
                                    >
                                        {darkMode ? <Sun size={16} /> : <Moon size={16} />}
                                    </button>
                                </div>

                                {/* Description */}
                                <p className={`text-xs leading-relaxed mb-5 ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>
                                    A structured checklist to guide system design decisions. Work through each phase, check off questions as you answer them, and add notes to document your decisions. Export your progress as Markdown when done.
                                </p>

                                {/* Progress */}
                                <div className="flex justify-center mb-6">
                                    <ProgressRing progress={calculateProgress()} darkMode={darkMode} size={100} />
                                </div>

                                {/* Project Name */}
                                <div className="mb-5">
                                    <label className={`block text-xs font-medium mb-1.5 ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>Project Name</label>
                                    <input
                                        type="text"
                                        placeholder="Enter project name..."
                                        value={projectName}
                                        onChange={(e) => setProjectName(e.target.value)}
                                        className={`w-full px-3 py-2 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                    />
                                </div>

                                {/* Stakeholders */}
                                <div className="mb-5">
                                    <div className="flex items-center gap-2 mb-3">
                                        <Users size={14} className={darkMode ? 'text-zinc-500' : 'text-zinc-400'} />
                                        <span className={`text-xs font-medium ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>Stakeholders</span>
                                    </div>

                                    {stakeholders.length > 0 && (
                                        <div className="mb-3 space-y-1.5">
                                            {stakeholders.map((s) => (
                                                <div key={s.id} className={`flex items-center justify-between px-2.5 py-1.5 rounded-lg text-sm ${darkMode ? 'bg-zinc-800' : 'bg-zinc-50'}`}>
                                                    <div className="flex-1 min-w-0 truncate">
                                                        <span className={`font-medium ${darkMode ? 'text-zinc-200' : 'text-zinc-800'}`}>{s.name}</span>
                                                        {s.role && (
                                                            <span className={`ml-1.5 text-xs ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>· {s.role}</span>
                                                        )}
                                                    </div>
                                                    <button
                                                        onClick={() => removeStakeholder(s.id)}
                                                        className={`p-0.5 rounded transition-colors ${darkMode ? 'hover:bg-zinc-700 text-zinc-600' : 'hover:bg-zinc-200 text-zinc-400'}`}
                                                    >
                                                        <X size={12} />
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    <div className="space-y-2">
                                        <input
                                            type="text"
                                            placeholder="Name"
                                            value={newStakeholder.name}
                                            onChange={(e) => setNewStakeholder(prev => ({ ...prev, name: e.target.value }))}
                                            onKeyDown={(e) => e.key === 'Enter' && addStakeholder()}
                                            className={`w-full px-2.5 py-1.5 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                        />
                                        <div className="flex gap-2">
                                            <input
                                                type="text"
                                                placeholder="Role (optional)"
                                                value={newStakeholder.role}
                                                onChange={(e) => setNewStakeholder(prev => ({ ...prev, role: e.target.value }))}
                                                onKeyDown={(e) => e.key === 'Enter' && addStakeholder()}
                                                className={`flex-1 px-2.5 py-1.5 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                            />
                                            <button
                                                onClick={addStakeholder}
                                                className={`px-2.5 py-1.5 rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-300' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-700'}`}
                                            >
                                                <Plus size={16} />
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                {/* References */}
                                <div className="mb-5">
                                    <div className="flex items-center gap-2 mb-3">
                                        <Link2 size={14} className={darkMode ? 'text-zinc-500' : 'text-zinc-400'} />
                                        <span className={`text-xs font-medium ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>References</span>
                                    </div>

                                    {references.length > 0 && (
                                        <div className="mb-3 space-y-1.5">
                                            {references.map((r) => (
                                                <div key={r.id} className={`flex items-center justify-between px-2.5 py-1.5 rounded-lg text-sm ${darkMode ? 'bg-zinc-800' : 'bg-zinc-50'}`}>
                                                    <a
                                                        href={r.url}
                                                        target="_blank"
                                                        rel="noopener noreferrer"
                                                        className={`flex-1 min-w-0 truncate flex items-center gap-1.5 ${darkMode ? 'text-zinc-300 hover:text-zinc-100' : 'text-zinc-700 hover:text-zinc-900'}`}
                                                    >
                                                        <ExternalLink size={12} className="flex-shrink-0" />
                                                        <span className="truncate">{r.title}</span>
                                                    </a>
                                                    <button
                                                        onClick={() => removeReference(r.id)}
                                                        className={`p-0.5 rounded transition-colors ml-2 ${darkMode ? 'hover:bg-zinc-700 text-zinc-600' : 'hover:bg-zinc-200 text-zinc-400'}`}
                                                    >
                                                        <X size={12} />
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    )}

                                    <div className="space-y-2">
                                        <input
                                            type="text"
                                            placeholder="Title (optional)"
                                            value={newReference.title}
                                            onChange={(e) => setNewReference(prev => ({ ...prev, title: e.target.value }))}
                                            className={`w-full px-2.5 py-1.5 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                        />
                                        <div className="flex gap-2">
                                            <input
                                                type="url"
                                                placeholder="URL"
                                                value={newReference.url}
                                                onChange={(e) => setNewReference(prev => ({ ...prev, url: e.target.value }))}
                                                onKeyDown={(e) => e.key === 'Enter' && addReference()}
                                                className={`flex-1 px-2.5 py-1.5 text-sm border rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-zinc-500/20 ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-100 placeholder:text-zinc-600' : 'bg-zinc-50 border-zinc-200 text-zinc-900 placeholder:text-zinc-400'}`}
                                            />
                                            <button
                                                onClick={addReference}
                                                className={`px-2.5 py-1.5 rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-300' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-700'}`}
                                            >
                                                <Plus size={16} />
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                {/* Spacer */}
                                <div className="flex-1" />

                                {/* Controls */}
                                <div className="space-y-2">
                                    <div className="flex gap-2">
                                        <button
                                            onClick={exportNotes}
                                            className={`flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-300' : 'bg-zinc-900 hover:bg-zinc-800 text-white'}`}
                                        >
                                            <Download size={16} />
                                            <span>Export</span>
                                        </button>
                                        <label className={`flex-1 flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-colors cursor-pointer ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-300' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-700'}`}>
                                            <Upload size={16} />
                                            <span>Import</span>
                                            <input
                                                type="file"
                                                accept=".md,.markdown,.txt"
                                                onChange={handleFileImport}
                                                className="hidden"
                                            />
                                        </label>
                                    </div>

                                    <div className="flex gap-2">
                                        <button
                                            onClick={expandAll}
                                            className={`flex-1 flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-400' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-600'}`}
                                        >
                                            <ChevronsDown size={14} />
                                            <span>Expand</span>
                                        </button>
                                        <button
                                            onClick={collapseAll}
                                            className={`flex-1 flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ${darkMode ? 'bg-zinc-800 hover:bg-zinc-700 text-zinc-400' : 'bg-zinc-100 hover:bg-zinc-200 text-zinc-600'}`}
                                        >
                                            <ChevronsUp size={14} />
                                            <span>Collapse</span>
                                        </button>
                                    </div>

                                    <button
                                        onClick={resetProgress}
                                        className={`w-full flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ${darkMode ? 'hover:bg-zinc-800 text-zinc-600' : 'hover:bg-zinc-100 text-zinc-400'}`}
                                    >
                                        <RotateCcw size={12} />
                                        <span>Reset Progress</span>
                                    </button>

                                    {lastSaved && (
                                        <div className={`flex items-center justify-center gap-1 text-xs ${darkMode ? 'text-zinc-600' : 'text-zinc-400'}`}>
                                            <Save size={10} />
                                            <span>Auto-saved</span>
                                        </div>
                                    )}

                                    <a
                                        href="https://github.com/adibhanna/arch.github.io"
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className={`flex items-center justify-center gap-1.5 text-xs mt-4 ${darkMode ? 'text-zinc-600 hover:text-zinc-400' : 'text-zinc-400 hover:text-zinc-600'}`}
                                    >
                                        <Github size={14} />
                                        <span>View on GitHub</span>
                                    </a>
                                </div>
                            </div>
                        </div>

                        {/* Main Content */}
                        <div className="flex-1 lg:pl-72">
                            {/* Mobile Header */}
                            <div className={`lg:hidden sticky top-0 z-10 p-4 border-b transition-colors duration-300 ${darkMode ? 'bg-zinc-900 border-zinc-800' : 'bg-white border-zinc-200'}`}>
                                <div className="flex items-center justify-between">
                                    <h1 className={`text-lg font-semibold ${darkMode ? 'text-zinc-100' : 'text-zinc-900'}`}>
                                        Architecture Framework
                                    </h1>
                                    <div className="flex items-center gap-2">
                                        <span className={`text-sm font-medium ${darkMode ? 'text-zinc-400' : 'text-zinc-600'}`}>{calculateProgress()}%</span>
                                        <button
                                            onClick={() => setDarkMode(!darkMode)}
                                            className={`p-1.5 rounded-lg transition-colors ${darkMode ? 'hover:bg-zinc-800 text-zinc-400' : 'hover:bg-zinc-100 text-zinc-600'}`}
                                        >
                                            {darkMode ? <Sun size={16} /> : <Moon size={16} />}
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div className="p-4 sm:p-6 lg:p-8">
                                {/* Phases */}
                                <div className="space-y-4 max-w-4xl">
                                    {framework.map((phase) => {
                                        const phaseChecked = phase.sections.reduce((acc, section, sIndex) => {
                                            return acc + section.questions.filter((_, qIndex) =>
                                                checkedItems[`${phase.id}-${sIndex}-${qIndex}`]
                                            ).length;
                                        }, 0);
                                        const phaseTotal = phase.sections.reduce((acc, section) => acc + section.questions.length, 0);

                                        return (
                                            <div key={phase.id} className={`rounded-2xl border overflow-hidden transition-colors duration-300 hover-lift ${darkMode ? 'bg-zinc-900 border-zinc-800' : 'bg-white border-zinc-200'}`}>
                                                {/* Phase Header */}
                                                <div className={`px-5 py-4 border-b ${darkMode ? 'border-zinc-800' : 'border-zinc-100'}`}>
                                                    <div className="flex items-start justify-between gap-4">
                                                        <div className="flex items-start gap-3">
                                                            <span className={`text-2xl font-semibold tabular-nums ${darkMode ? 'text-zinc-700' : 'text-zinc-300'}`}>{phase.number}</span>
                                                            <div className="flex-1">
                                                                <h2 className={`text-base font-semibold ${darkMode ? 'text-zinc-100' : 'text-zinc-900'}`}>
                                                                    {phase.phase}
                                                                </h2>
                                                                <p className={`text-sm mt-1 leading-relaxed ${darkMode ? 'text-zinc-500' : 'text-zinc-500'}`}>
                                                                    {phase.description}
                                                                </p>
                                                            </div>
                                                        </div>
                                                        <div className={`text-sm font-medium tabular-nums px-2 py-0.5 rounded-md ${darkMode ? 'bg-zinc-800 text-zinc-400' : 'bg-zinc-100 text-zinc-600'}`}>
                                                            {phaseChecked}/{phaseTotal}
                                                        </div>
                                                    </div>
                                                </div>

                                                {/* Sections */}
                                                <div className={`divide-y ${darkMode ? 'divide-zinc-800' : 'divide-zinc-100'}`}>
                                                    {phase.sections.map((section, sIndex) => {
                                                        const sectionKey = `${phase.id}-${sIndex}`;
                                                        const isExpanded = expandedSections[sectionKey];
                                                        const sectionChecked = section.questions.filter((_, qIndex) =>
                                                            checkedItems[`${phase.id}-${sIndex}-${qIndex}`]
                                                        ).length;

                                                        return (
                                                            <div key={sIndex}>
                                                                <button
                                                                    onClick={() => toggleSection(phase.id, sIndex)}
                                                                    className={`w-full px-5 py-3 flex items-center justify-between transition-colors ${darkMode ? 'hover:bg-zinc-800/50' : 'hover:bg-zinc-50'}`}
                                                                >
                                                                    <div className="flex items-center gap-2.5">
                                                                        <ChevronDown
                                                                            size={14}
                                                                            className={`transition-transform duration-200 ${darkMode ? 'text-zinc-600' : 'text-zinc-400'} ${isExpanded ? 'rotate-0' : '-rotate-90'}`}
                                                                        />
                                                                        <h3 className={`text-sm font-medium ${darkMode ? 'text-zinc-300' : 'text-zinc-700'}`}>
                                                                            {section.title}
                                                                        </h3>
                                                                    </div>
                                                                    <div className="flex items-center gap-2.5">
                                                                        <div className={`w-12 h-1 rounded-full overflow-hidden ${darkMode ? 'bg-zinc-800' : 'bg-zinc-200'}`}>
                                                                            <div
                                                                                className={`h-full rounded-full transition-all duration-500 ${darkMode ? 'bg-zinc-600' : 'bg-zinc-500'}`}
                                                                                style={{ width: `${(sectionChecked / section.questions.length) * 100}%` }}
                                                                            />
                                                                        </div>
                                                                        <span className={`text-xs font-medium tabular-nums ${darkMode ? 'text-zinc-600' : 'text-zinc-400'}`}>
                                                                            {sectionChecked}/{section.questions.length}
                                                                        </span>
                                                                    </div>
                                                                </button>

                                                                {isExpanded && (
                                                                    <div className="px-5 pb-4 section-expand">
                                                                        {section.description && (
                                                                            <p className={`ml-6 mb-3 text-xs ${darkMode ? 'text-zinc-600' : 'text-zinc-400'}`}>
                                                                                {section.description}
                                                                            </p>
                                                                        )}
                                                                        <div className="space-y-2 ml-6">
                                                                            {section.questions.map((questionItem, qIndex) => {
                                                                                const itemKey = `${phase.id}-${sIndex}-${qIndex}`;
                                                                                const isChecked = checkedItems[itemKey];
                                                                                const note = notes[itemKey] || '';
                                                                                const code = codeSnippets[itemKey] || '';
                                                                                const diagram = diagrams[itemKey] || '';
                                                                                const activeTab = activeTabs[itemKey] || 'notes';
                                                                                const questionText = typeof questionItem === 'string' ? questionItem : questionItem.q;
                                                                                const questionTip = typeof questionItem === 'object' ? questionItem.tip : null;

                                                                                return (
                                                                                    <div key={qIndex} className={`p-3 rounded-lg transition-colors ${isChecked ? (darkMode ? 'bg-zinc-800/50' : 'bg-zinc-50') : ''}`}>
                                                                                        <div className="flex items-start gap-3">
                                                                                            <button
                                                                                                onClick={() => toggleCheck(phase.id, sIndex, qIndex)}
                                                                                                className="mt-0.5 flex-shrink-0 checkbox-custom"
                                                                                            >
                                                                                                {isChecked ? (
                                                                                                    <CheckCircle2 size={18} className={darkMode ? 'text-zinc-500' : 'text-zinc-600'} />
                                                                                                ) : (
                                                                                                    <Circle size={18} className={darkMode ? 'text-zinc-700 hover:text-zinc-600' : 'text-zinc-300 hover:text-zinc-400'} />
                                                                                                )}
                                                                                            </button>
                                                                                            <div className="flex-1 min-w-0">
                                                                                                <div className="flex items-start gap-1.5">
                                                                                                    <span className={`text-sm leading-relaxed ${isChecked ? (darkMode ? 'text-zinc-600' : 'text-zinc-400') : (darkMode ? 'text-zinc-300' : 'text-zinc-700')}`}>
                                                                                                        {questionText}
                                                                                                    </span>
                                                                                                    {questionTip && (
                                                                                                        <Tooltip content={questionTip} darkMode={darkMode}>
                                                                                                            <HelpCircle size={14} className={`flex-shrink-0 mt-0.5 ${darkMode ? 'text-zinc-600 hover:text-zinc-400' : 'text-zinc-400 hover:text-zinc-600'}`} />
                                                                                                        </Tooltip>
                                                                                                    )}
                                                                                                </div>

                                                                                                {/* Tabs */}
                                                                                                <div className="flex items-center gap-1 mt-2 mb-2">
                                                                                                    <button
                                                                                                        onClick={() => setActiveTab(phase.id, sIndex, qIndex, 'notes')}
                                                                                                        className={`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${activeTab === 'notes' ? (darkMode ? 'bg-zinc-700 text-zinc-200' : 'bg-zinc-200 text-zinc-800') : (darkMode ? 'text-zinc-500 hover:text-zinc-400' : 'text-zinc-500 hover:text-zinc-600')}`}
                                                                                                    >
                                                                                                        <FileText size={12} />
                                                                                                        <span>Notes</span>
                                                                                                    </button>
                                                                                                    <button
                                                                                                        onClick={() => setActiveTab(phase.id, sIndex, qIndex, 'code')}
                                                                                                        className={`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${activeTab === 'code' ? (darkMode ? 'bg-zinc-700 text-zinc-200' : 'bg-zinc-200 text-zinc-800') : (darkMode ? 'text-zinc-500 hover:text-zinc-400' : 'text-zinc-500 hover:text-zinc-600')}`}
                                                                                                    >
                                                                                                        <Code size={12} />
                                                                                                        <span>Code</span>
                                                                                                    </button>
                                                                                                    <button
                                                                                                        onClick={() => setActiveTab(phase.id, sIndex, qIndex, 'diagram')}
                                                                                                        className={`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${activeTab === 'diagram' ? (darkMode ? 'bg-zinc-700 text-zinc-200' : 'bg-zinc-200 text-zinc-800') : (darkMode ? 'text-zinc-500 hover:text-zinc-400' : 'text-zinc-500 hover:text-zinc-600')}`}
                                                                                                    >
                                                                                                        <GitBranch size={12} />
                                                                                                        <span>Diagram</span>
                                                                                                    </button>
                                                                                                </div>

                                                                                                {/* Notes Tab */}
                                                                                                {activeTab === 'notes' && (
                                                                                                    <textarea
                                                                                                        placeholder="Add notes..."
                                                                                                        value={note}
                                                                                                        onChange={(e) => updateNote(phase.id, sIndex, qIndex, e.target.value)}
                                                                                                        className={`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-500/20 resize-none transition-colors ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-300 placeholder:text-zinc-700' : 'bg-white border-zinc-200 text-zinc-700 placeholder:text-zinc-400'}`}
                                                                                                        rows="2"
                                                                                                    />
                                                                                                )}

                                                                                                {/* Code Tab */}
                                                                                                {activeTab === 'code' && (
                                                                                                    <textarea
                                                                                                        placeholder="Add code snippet..."
                                                                                                        value={code}
                                                                                                        onChange={(e) => updateCodeSnippet(phase.id, sIndex, qIndex, e.target.value)}
                                                                                                        className={`w-full px-3 py-2 text-sm font-mono border rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-500/20 resize-none transition-colors ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-300 placeholder:text-zinc-700' : 'bg-white border-zinc-200 text-zinc-700 placeholder:text-zinc-400'}`}
                                                                                                        rows="4"
                                                                                                    />
                                                                                                )}

                                                                                                {/* Diagram Tab */}
                                                                                                {activeTab === 'diagram' && (
                                                                                                    <div className="space-y-3">
                                                                                                        <textarea
                                                                                                            placeholder="Enter mermaid diagram code...&#10;&#10;Example:&#10;graph TD&#10;    A[Start] --> B[Process]&#10;    B --> C[End]"
                                                                                                            value={diagram}
                                                                                                            onChange={(e) => updateDiagram(phase.id, sIndex, qIndex, e.target.value)}
                                                                                                            className={`w-full px-3 py-2 text-sm font-mono border rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-500/20 resize-none transition-colors ${darkMode ? 'bg-zinc-800 border-zinc-700 text-zinc-300 placeholder:text-zinc-700' : 'bg-white border-zinc-200 text-zinc-700 placeholder:text-zinc-400'}`}
                                                                                                            rows="4"
                                                                                                        />
                                                                                                        {diagram && (
                                                                                                            <div className={`p-3 border rounded-lg overflow-auto ${darkMode ? 'bg-zinc-800 border-zinc-700' : 'bg-white border-zinc-200'}`}>
                                                                                                                <MermaidDiagram code={diagram} darkMode={darkMode} id={itemKey} />
                                                                                                            </div>
                                                                                                        )}
                                                                                                    </div>
                                                                                                )}
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                );
                                                                            })}
                                                                        </div>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>

                                <p className={`text-center text-xs mt-8 ${darkMode ? 'text-zinc-700' : 'text-zinc-400'}`}>
                                    {totalQuestions} questions across {framework.length} phases
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ArchitectureFramework />, document.getElementById('root'));
    </script>
</body>
</html>
